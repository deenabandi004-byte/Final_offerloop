import{r as u,u as I,j as e,s as U,a5 as B,a3 as _,l}from"./vendor-react-b5qb9EdN.js";import{a as A,P as T,B as h,G as f}from"./index-B_VQ6MHu.js";import{l as $}from"./vendor-stripe-U9JJOqTM.js";import{g}from"./vendor-firebase-C23ypVz2.js";const k="pk_live_51S4BB8ERY2WrVHp1acXrKE6RBG7NBlfHcMZ2kf7XhCX2E5g8Lasedx6ntcaD1H4BsoUMBGYXIcKHcAB4JuohLa2B00j7jtmWnB",L=$(k),R=k.startsWith("pk_test_")?"price_1ScIyzERY2WrVHp1m9pJSNlK":"price_1SQ0IJERY2WrVHp1Ul5OrP63",M=()=>{const[m,d]=u.useState(!1),[r,E]=u.useState(null),j=I(),{user:n,updateUser:S}=A();u.useEffect(()=>{n&&P()},[n]);const P=async()=>{try{const t=g().currentUser;if(!t)return;const c=await t.getIdToken(),x=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",a=await fetch(`${x}/api/subscription-status`,{headers:{Authorization:`Bearer ${c}`}});if(a.ok){const i=await a.json();E(i)}}catch(s){console.error("Failed to fetch subscription status:",s)}},w=async()=>{if(n){d(!0);try{const t=g().currentUser;if(!t)throw new Error("No Firebase user found");const c=await t.getIdToken(),x=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",a=await fetch(`${x}/api/create-portal-session`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({returnUrl:`${window.location.origin}/pricing`})});if(!a.ok)throw new Error("Failed to create portal session");const{url:i}=await a.json();window.location.href=i}catch(s){console.error("Portal error:",s),alert("Failed to open subscription management. Please try again.")}finally{d(!1)}}},C=async()=>{if(!n){console.error("User not authenticated");return}d(!0);try{const t=g().currentUser;if(!t)throw new Error("No Firebase user found");const c=await t.getIdToken(),x=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",a=await fetch(`${x}/api/create-checkout-session`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({priceId:R,userId:n.uid,userEmail:n.email,successUrl:`${window.location.origin}/payment-success?session_id={CHECKOUT_SESSION_ID}`,cancelUrl:`${window.location.origin}/pricing`})});if(!a.ok){const v=await a.text();throw console.error("Checkout session creation failed:",a.status,v),new Error(`Failed to create checkout session: ${a.status} - ${v}`)}const i=await a.json();console.log("Checkout session response:",i);const b=i.sessionId;if(!b)throw console.error("No sessionId in response:",i),new Error("Invalid response from server: missing sessionId");const y=await L;if(!y)throw new Error("Stripe failed to initialize");const{error:p}=await y.redirectToCheckout({sessionId:b});p&&(console.error("Stripe redirect error:",p),alert("Payment error: "+p.message))}catch(s){console.error("Checkout error:",s);const t=s instanceof Error?s.message:"Unknown error";alert(`Something went wrong: ${t}`)}finally{d(!1)}},N=async s=>{if(n)try{s==="free"?(await S({tier:"free",credits:150,maxCredits:150}),j("/home")):s==="pro"&&await C()}catch(t){console.error("Error updating user:",t)}},o=(r==null?void 0:r.tier)==="pro"&&(r==null?void 0:r.status)==="active";return e.jsx(T,{children:e.jsxs("div",{className:"container mx-auto px-6 py-6 max-w-6xl",children:[e.jsxs(h,{variant:"ghost",onClick:()=>j("/home"),className:"mb-8 text-gray-300 text-slate-700 hover:text-blue-400",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Back to Home"]}),o&&e.jsxs(f,{className:"mb-8 p-4 rounded-xl flex items-center justify-between border-blue-500/30",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-blue-400",children:"Pro Subscription Active"}),(r==null?void 0:r.cancelAtPeriodEnd)&&e.jsxs("p",{className:"text-sm text-gray-400 text-slate-600",children:["Cancels on ",new Date(r.currentPeriodEnd*1e3).toLocaleDateString()]})]}),e.jsxs(h,{onClick:w,disabled:m,className:"btn-primary-glass",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Manage Subscription"]})]}),e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 bg-blue-500/20 px-3 py-1 rounded-full border border-blue-500/30",children:[e.jsx(_,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{className:"text-sm font-medium text-blue-400 uppercase tracking-wide",children:"Our Pricing"})]})}),e.jsxs("h1",{className:"text-display-lg mb-6 text-white text-slate-900",children:[e.jsx("span",{className:"text-black",children:"Choose"})," ",e.jsx("span",{className:"gradient-text-teal",children:"your plan"})," ",e.jsx("span",{className:"text-black",children:"today"})]}),e.jsx("p",{className:"text-gray-400 text-slate-600 text-lg mb-8",children:"15 credits per contact. When you run out of credits, no more contacts."})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 max-w-6xl w-full",children:[e.jsxs(f,{className:"rounded-2xl p-10 transform transition-all hover:scale-[1.02] hover:glow-teal",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h3",{className:"text-3xl font-bold mb-3 text-white text-slate-900",children:"Free"}),e.jsx("p",{className:"text-gray-400 text-slate-600",children:"Try out platform risk free"})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"150 credits (10 emails) "})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"Estimated time saved: 250 minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"Try out platform risk free"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"Limited Features"})]})]}),e.jsx(h,{className:"btn-secondary-glass w-full py-4 px-6 font-semibold",onClick:()=>N("free"),disabled:o,children:o?"Current Plan: Pro":"Start for free"})]}),e.jsxs(f,{className:"relative rounded-2xl p-10 transform transition-all hover:scale-[1.02] hover:glow-teal border-2 border-blue-500/50",children:[e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("span",{className:"px-3 py-1 rounded-full bg-blue-500/20 text-blue-400 border border-blue-500/30 text-xs font-medium",children:o?"ACTIVE":"RECOMMENDED"})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h3",{className:"text-3xl font-bold mb-3 gradient-text-teal",children:"Pro"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-gray-400 text-slate-600 text-xl line-through mr-2",children:"$34.99"}),e.jsx("span",{className:"text-3xl font-bold text-white text-slate-900",children:"$8.99"}),e.jsx("span",{className:"text-gray-400 text-slate-600 text-lg ml-1",children:"/month"})]}),e.jsx("p",{className:"text-gray-300 text-slate-700",children:"1800 credits"})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"1800 credits (120 emails) "})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"Estimated time saved: 2500 minutes"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"Everything in free plus:"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"Directory permanently saves"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"Priority Support"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l,{className:"h-5 w-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-slate-700",children:"Advanced features"})]})]}),e.jsx(h,{className:"btn-primary-glass w-full py-6 px-6 text-lg font-semibold",onClick:o?w:()=>N("pro"),disabled:m,children:m?"Processing...":o?"Manage Subscription":"Start now"})]})]})})]})})};export{M as default};
