import{j as e}from"./vendor-ui-Dvm6rNa4.js";import{u as w,r as n}from"./vendor-react-BYoYq924.js";import{a as v,B as c,A as C,t as m}from"./index-BlHBLROI.js";import{S as P,A,a as D,C as f,b as S}from"./AppSidebar-Cn2aJ38A.js";import{Z as k}from"./zap-4xeOdT8m.js";import{D as F,a as x}from"./api-BaCf4yf7.js";import{F as L}from"./file-text-anY0C2WZ.js";import{L as p}from"./loader-circle-Dc92CH8W.js";import{B as E}from"./badge-check-8cj4Bimp.js";import{M as B}from"./map-pin-ChQYAUwW.js";import{T as R}from"./trash-2-CokCcdpM.js";import"./input-XODqQdub.js";import"./avatar-Dzw8yNMj.js";import"./user-C_wegfzu.js";import"./search-BYePgFCK.js";import"./briefcase-dTGXHmKy.js";import"./credit-card-CUtRkOcf.js";import"./settings-DRsa6wdQ.js";import"./chevron-down-BYs8h_N4.js";function T({credits:r,max:i}){const l=r===0?"red":r<30?"amber":"blue",d=l==="red"?"bg-red-500/15 text-red-700 ring-red-400/30":l==="amber"?"bg-amber-500/15 text-amber-700 ring-amber-400/30":"bg-blue-500/15 text-blue-700 ring-blue-400/30";return e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full ring-1 ${d}`,children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"tabular-nums",children:r}),e.jsxs("span",{className:"opacity-70",children:["/ ",i]})]})}const se=()=>{const{user:r}=v(),i=w(),[l,d]=n.useState([]),[b,u]=n.useState(!0),[h,g]=n.useState(null);n.useEffect(()=>{(async()=>{var a;try{console.log("ðŸ” Starting to load coffee chat preps...");const t=await x.getAllCoffeeChatPreps();if(console.log("ðŸ“¦ Raw result from API:",t),"error"in t)throw console.error("âŒ Error in result:",t.error),new Error(t.error);console.log("âœ… Preps received:",t.preps),console.log("ðŸ“Š Number of preps:",((a=t.preps)==null?void 0:a.length)||0),d(t.preps||[])}catch(t){console.error("ðŸ’¥ Failed to load coffee chat preps:",t),m({title:"Unable to load library",description:t instanceof Error?t.message:"Please try again.",variant:"destructive"})}finally{u(!1),console.log("ðŸ Loading complete")}})()},[]);const j=async s=>{try{if(s.pdfUrl){window.open(s.pdfUrl,"_blank","noopener");return}const{pdfUrl:a}=await x.downloadCoffeeChatPDF(s.id);if(a)window.open(a,"_blank","noopener");else throw new Error("PDF URL not available yet")}catch{m({title:"Download failed",description:"Could not open the PDF. Please try again.",variant:"destructive"})}},y=async s=>{g(s);try{const a=await x.deleteCoffeeChatPrep(s);if("error"in a)throw new Error(a.error);d(t=>t.filter(N=>N.id!==s)),m({title:"Prep deleted",description:"Removed from your Coffee Chat Library."})}catch(a){m({title:"Delete failed",description:a instanceof Error?a.message:"Please try again.",variant:"destructive"})}finally{g(null)}},o=n.useMemo(()=>{const s=l.filter(t=>t.status==="completed"),a=l.filter(t=>t.status!=="completed");return{completed:s,inProgress:a}},[l]);return e.jsx(P,{children:e.jsxs("div",{className:"flex min-h-screen w-full bg-gray-900 text-white",children:[e.jsx(A,{}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("header",{className:"h-16 flex items-center justify-between border-b border-gray-800 px-6 bg-gray-900/80 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(D,{className:"text-white hover:bg-gray-800/50"}),e.jsx("h1",{className:"text-xl font-semibold",children:"Coffee Chat Library"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(T,{credits:(r==null?void 0:r.credits)??0,max:(r==null?void 0:r.maxCredits)??120}),e.jsxs(c,{size:"sm",onClick:()=>i("/home"),variant:"outline",className:"border-gray-600 hover:border-gray-500",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Back to Home"]})]})]}),e.jsx("main",{className:"p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold text-white flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5 text-blue-400"}),"Saved Coffee Chat Preps"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Review, download, or delete the one-pagers youâ€™ve generated."})]}),e.jsxs(c,{onClick:()=>i("/home?tab=coffee-chat"),className:"text-white hover:opacity-90",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Create New Prep"]})]}),b?e.jsx("div",{className:"flex items-center justify-center h-48 rounded-xl border border-gray-800 bg-gray-900/80",children:e.jsxs("div",{className:"flex items-center gap-3 text-gray-300",children:[e.jsx(p,{className:"h-5 w-5 animate-spin text-blue-400"}),"Loading your library..."]})}):l.length===0?e.jsxs("div",{className:"rounded-xl border border-gray-800 bg-gray-900/80 p-10 text-center space-y-4",children:[e.jsx(f,{className:"h-10 w-10 mx-auto text-blue-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"No preps yet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Generate your first coffee chat prep to see it appear here."}),e.jsx(c,{onClick:()=>i("/home?tab=coffee-chat"),className:"text-white hover:opacity-90",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:"Create Coffee Chat Prep"})]}):e.jsxs("div",{className:"space-y-6",children:[o.inProgress.length>0&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-400 uppercase mb-3",children:"In Progress"}),e.jsx("div",{className:"grid gap-4",children:o.inProgress.map(s=>e.jsxs("div",{className:"rounded-lg border border-yellow-500/40 bg-yellow-500/10 px-5 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-200 font-medium",children:s.contactName}),e.jsxs("p",{className:"text-xs text-gray-400",children:[s.jobTitle," @ ",s.company]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Requested ",s.createdAt?new Date(s.createdAt).toLocaleString():""]})]}),e.jsx("div",{className:"text-xs uppercase text-yellow-300",children:"Processing..."})]},s.id))})]}),o.completed.length>0&&e.jsxs("section",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-400 uppercase",children:["Completed (",o.completed.length,")"]}),e.jsx("div",{className:"grid gap-4",children:o.completed.map(s=>e.jsxs("div",{className:"rounded-xl border border-gray-800 bg-gray-900/80 p-5 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-white font-medium",children:[e.jsx(E,{className:"h-4 w-4 text-blue-400"}),s.contactName]}),e.jsxs("div",{className:"text-sm text-gray-300",children:[s.jobTitle," @ ",s.company]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(S,{className:"h-3 w-3"}),s.createdAt?new Date(s.createdAt).toLocaleDateString():"â€”"]}),s.hometown&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"h-3 w-3"}),s.hometown]})]}),s.industrySummary&&e.jsx("p",{className:"text-xs text-gray-400",children:s.industrySummary})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(c,{size:"sm",variant:"outline",className:"border-blue-500/60 text-blue-200 hover:bg-blue-500/10",onClick:()=>j(s),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"PDF"]}),e.jsx(c,{size:"sm",variant:"ghost",className:"text-red-300 hover:text-red-200",disabled:h===s.id,onClick:()=>y(s.id),children:h===s.id?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(R,{className:"h-4 w-4"})})]})]},s.id))})]})]})]})})]})]})})};export{se as default};
