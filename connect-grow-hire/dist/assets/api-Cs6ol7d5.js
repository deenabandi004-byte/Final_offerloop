const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DlXH6OO2.js","assets/vendor-react-Bye97upB.js","assets/vendor-utils-B2rm_Apj.js","assets/vendor-dates-CPvpAlHY.js","assets/vendor-firebase-Bz1e_Tmy.js","assets/vendor-animations-CH_iu5NA.js","assets/index-BSrx6Tbf.css"])))=>i.map(i=>d[i]);
import{_ as m}from"./index-DlXH6OO2.js";const g="https://www.offerloop.ai/api";function y(l){return"error"in l&&typeof l.error=="string"}class f{async getIdToken(e=!1){try{const{auth:t}=await m(async()=>{const{auth:s}=await import("./index-DlXH6OO2.js").then(function(c){return c.j});return{auth:s}},__vite__mapDeps([0,1,2,3,4,5,6])),{onAuthStateChanged:r}=await m(async()=>{const{onAuthStateChanged:s}=await import("./vendor-firebase-Bz1e_Tmy.js").then(function(c){return c.D});return{onAuthStateChanged:s}},__vite__mapDeps([4,1,2,3]));let a=null;const o=await new Promise((s,c)=>{const u=setTimeout(()=>{a&&a(),s(null)},5e3);a=r(t,h=>{clearTimeout(u),a&&a(),s(h)},h=>{clearTimeout(u),a&&a(),c(h)})});if(!o){console.error("No authenticated user found. Please sign in.");const s=new Error("Authentication required. Please sign in again.");throw s.status=401,s.needsAuth=!0,s}const d=await o.getIdToken(e);if(!d){console.error("Failed to get ID token");const s=new Error("Failed to get authentication token. Please sign in again.");throw s.status=401,s.needsAuth=!0,s}return d}catch(t){if(console.error("Error getting Firebase auth token:",t),t.status===401&&t.needsAuth)throw t;const r=new Error("Authentication required. Please sign in again.");throw r.status=401,r.needsAuth=!0,r}}async getAuthHeaders(){const e={"Content-Type":"application/json"};try{const t=await this.getIdToken();e.Authorization=`Bearer ${t}`}catch(t){if(console.error("Error getting Firebase auth headers:",t),t.status===401&&t.needsAuth)throw t;const r=new Error("Authentication required. Please sign in again.");throw r.status=401,r.needsAuth=!0,r}return e}async makeRequest(e,t={}){var c,u;const r=`${g}${e}`,a=await fetch(r,t),n=a.headers.get("content-type")||"",o=a.headers.get("content-disposition")||"";if(n.includes("text/csv")||n.includes("application/pdf")||o.includes("attachment")){const h=await a.blob();if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return h}const d=await a.text();let s={};if(d)try{s=JSON.parse(d)}catch{s={raw:d}}if(!a.ok){if(a.status===401){const i=new Error((s==null?void 0:s.message)||(s==null?void 0:s.error)||"Authentication required. Please sign in again.");throw i.status=401,i.needsAuth=(s==null?void 0:s.needsAuth)||(s==null?void 0:s.require_reauth)||!0,i.authUrl=s==null?void 0:s.authUrl,i.contacts=s==null?void 0:s.contacts,console.error("401 Unauthorized - Authentication failed:",{endpoint:e,hasToken:!!((c=t.headers)!=null&&c.Authorization),errorMessage:(s==null?void 0:s.error)||(s==null?void 0:s.message)}),i}if(a.status===402&&s){const i=new Error(s.error||s.message||"Insufficient credits");throw i.status=402,i.error_code=s.error_code||"INSUFFICIENT_CREDITS",s.details&&(i.required=s.details.required,i.available=s.details.available,i.creditsNeeded=s.details.required,i.currentCredits=s.details.available),i}if(a.status===502&&s){const i=new Error(s.error||s.message||"The search service is temporarily unavailable. Please try again in a few minutes.");throw i.status=502,i.error_code=s.error_code||"EXTERNAL_API_ERROR",i.service=((u=s.details)==null?void 0:u.service)||"Search Service",i}const h=s&&(s.error||s.message||s.detail)||`HTTP ${a.status}: ${a.statusText}`;throw new Error(h)}return s??{}}async runFreeSearch(e){const t=await this.getAuthHeaders(),r={jobTitle:e.jobTitle,company:e.company,location:e.location,saveToDirectory:!1,userProfile:e.userProfile,careerInterests:e.careerInterests||[],collegeAlumni:e.collegeAlumni||"",batchSize:e.batchSize};return this.makeRequest("/free-run",{method:"POST",headers:t,body:JSON.stringify(r)})}async runProSearch(e){const t=await this.getIdToken(),r=new FormData;return r.append("jobTitle",e.jobTitle),r.append("company",e.company),r.append("location",e.location),r.append("resume",e.resume),r.append("saveToDirectory","false"),r.append("collegeAlumni",e.collegeAlumni||""),e.batchSize&&r.append("batchSize",e.batchSize.toString()),e.userProfile&&r.append("userProfile",JSON.stringify(e.userProfile)),e.careerInterests&&e.careerInterests.length>0&&r.append("careerInterests",JSON.stringify(e.careerInterests)),this.makeRequest("/pro-run",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:r})}async runFreeSearchCsv(e){const t=await this.getAuthHeaders(),r={jobTitle:e.jobTitle,company:e.company,location:e.location,saveToDirectory:!1,userProfile:e.userProfile,careerInterests:e.careerInterests||[],collegeAlumni:e.collegeAlumni||""};return this.makeRequest("/free-run-csv",{method:"POST",headers:t,body:JSON.stringify(r)})}async runProSearchCsv(e){const t=await this.getIdToken(),r=new FormData;return r.append("jobTitle",e.jobTitle),r.append("company",e.company),r.append("location",e.location),r.append("resume",e.resume),r.append("saveToDirectory","false"),r.append("collegeAlumni",e.collegeAlumni||""),e.userProfile&&r.append("userProfile",JSON.stringify(e.userProfile)),e.careerInterests&&e.careerInterests.length>0&&r.append("careerInterests",JSON.stringify(e.careerInterests)),this.makeRequest("/pro-run-csv",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:r})}async runBasicSearch(e){return console.warn("runBasicSearch is deprecated. Use runFreeSearch() instead."),this.runFreeSearch(e)}async runAdvancedSearch(e){return console.warn("runAdvancedSearch is deprecated. Redirecting to Free tier."),this.runFreeSearch(e)}async parseSearchPrompt(e){const t=await this.getAuthHeaders();return this.makeRequest("/search/parse-prompt",{method:"POST",headers:t,body:JSON.stringify({prompt:e})})}async promptSearch(e,t=8){const r=await this.getAuthHeaders();return this.makeRequest("/prompt-search",{method:"POST",headers:r,body:JSON.stringify({prompt:e,max_contacts:t})})}async createCoffeeChatPrep(e){const t=await this.getAuthHeaders();return this.makeRequest("/coffee-chat-prep",{method:"POST",headers:t,body:JSON.stringify(e)})}async getCoffeeChatPrepStatus(e){const t=await this.getAuthHeaders();return this.makeRequest(`/coffee-chat-prep/${e}`,{method:"GET",headers:t})}async downloadCoffeeChatPDF(e){const t=await this.getAuthHeaders();return this.makeRequest(`/coffee-chat-prep/${e}/download`,{method:"GET",headers:t})}async getAllCoffeeChatPreps(){const e=await this.getAuthHeaders();return this.makeRequest("/coffee-chat-prep/all",{method:"GET",headers:e})}async getCoffeeChatHistory(e=10){const t=await this.getAuthHeaders();return this.makeRequest(`/coffee-chat-prep/history?limit=${e}`,{method:"GET",headers:t})}async generateInterviewPrep(e){const t=await this.getAuthHeaders();return this.makeRequest("/interview-prep/generate",{method:"POST",headers:t,body:JSON.stringify(e)})}async getInterviewPrepStatus(e){const t=await this.getAuthHeaders();return this.makeRequest(`/interview-prep/status/${e}`,{method:"GET",headers:t})}async downloadInterviewPrepPDF(e){const t=await this.getAuthHeaders();return this.makeRequest(`/interview-prep/download/${e}`,{method:"GET",headers:t})}async getInterviewPrepHistory(e=10){const t=await this.getAuthHeaders();return this.makeRequest(`/interview-prep/history?limit=${e}`,{method:"GET",headers:t})}async searchFirms(e,t=10){const r=await this.getAuthHeaders();return this.makeRequest("/firm-search/search",{method:"POST",headers:r,body:JSON.stringify({query:e,batchSize:t})})}async getFirmSearchHistory(e=10,t=!1){const r=await this.getAuthHeaders(),a=t?"&includeFirms=true":"";return(await this.makeRequest(`/firm-search/history?limit=${e}${a}`,{method:"GET",headers:r})).searches||[]}async getFirmSearchById(e){const t=await this.getAuthHeaders();try{const r=await this.makeRequest(`/firm-search/history/${e}`,{method:"GET",headers:t});return r.success&&r.search?{success:!0,firms:r.search.results||[],total:r.search.resultsCount||0,parsedFilters:r.search.parsedFilters}:null}catch(r){return console.error("Error getting firm search:",r),null}}async deleteFirm(e){var a;const t=await this.getAuthHeaders(),r={firmId:e.id,firmName:e.name,firmLocation:(a=e.location)==null?void 0:a.display};console.log("üóëÔ∏è API: Deleting firm with payload:",r),console.log("üóëÔ∏è API: Full firm object:",JSON.stringify(e,null,2));try{const n=await this.makeRequest("/firm-search/delete-firm",{method:"POST",headers:t,body:JSON.stringify(r)});return console.log("üóëÔ∏è API: Delete result:",JSON.stringify(n,null,2)),n.success&&(n.deletedCount===0?(console.error("‚ùå Delete returned success but deletedCount is 0 - no firms were found to delete!"),console.error("   This means the firm matching logic did not find any matching firms in Firebase."),console.error("   Check backend logs to see why matching failed.")):console.log(`‚úÖ Successfully deleted ${n.deletedCount} firm occurrence(s) from Firebase`)),n}catch(n){return console.error("‚ùå API: Error deleting firm:",n),{success:!1,error:n instanceof Error?n.message:"Failed to delete firm"}}}async startGmailOAuth(){const e=await this.getAuthHeaders(),{authUrl:t}=await this.makeRequest("/google/oauth/start",{headers:e});return t}async gmailStatus(){const e=await this.getAuthHeaders();return this.makeRequest("/google/gmail/status",{headers:e})}async saveGmailDraft(e){const t=await this.getAuthHeaders();return this.makeRequest("/gmail/drafts",{method:"POST",headers:t,body:JSON.stringify(e)})}async getTierInfo(){const e=await this.getAuthHeaders();return this.makeRequest("/tier-info",{headers:e})}async checkCredits(){const e=await this.getAuthHeaders();return this.makeRequest("/check-credits",{headers:e})}async checkHealth(){return this.makeRequest("/health")}async deleteCoffeeChatPrep(e){const t=await this.getAuthHeaders();return this.makeRequest(`/coffee-chat-prep/${e}`,{method:"DELETE",headers:t})}async checkContactReplies(e){const t=await this.getAuthHeaders();return this.makeRequest(`/contacts/${e}/check-replies`,{method:"GET",headers:t})}async batchCheckReplies(e){const t=await this.getAuthHeaders();return this.makeRequest("/contacts/batch-check-replies",{method:"POST",headers:t,body:JSON.stringify({contactIds:e})})}async muteContactNotifications(e,t){const r=await this.getAuthHeaders();return this.makeRequest(`/contacts/${e}/mute-notifications`,{method:"POST",headers:r,body:JSON.stringify({muted:t})})}async generateReplyDraft(e){const t=await this.getAuthHeaders();return this.makeRequest(`/contacts/${e}/generate-reply`,{method:"POST",headers:t})}async getDashboardStats(){const e=await this.getAuthHeaders();return this.makeRequest("/dashboard/stats",{method:"GET",headers:e})}async getRecommendations(){const e=await this.getAuthHeaders();return this.makeRequest("/dashboard/recommendations",{method:"GET",headers:e})}async getFirmLocations(){const e=await this.getAuthHeaders();return this.makeRequest("/dashboard/firm-locations",{method:"GET",headers:e})}async getInterviewPrepStats(){const e=await this.getAuthHeaders();return this.makeRequest("/dashboard/interview-prep-stats",{method:"GET",headers:e})}async getOutboxThreads(){const e=await this.getAuthHeaders();return this.makeRequest("/outbox/threads",{method:"GET",headers:e})}async regenerateOutboxReply(e){const t=await this.getAuthHeaders();return this.makeRequest(`/outbox/threads/${e}/regenerate`,{method:"POST",headers:t,body:JSON.stringify({})})}downloadCsv(e,t="contacts.csv"){const r=window.URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r)}async generateTimeline(e,t=!1,r){const a=await this.getAuthHeaders(),n={prompt:e};t&&r&&(n.isUpdate=!0,n.existingTimeline=r);const o=await this.makeRequest("/timeline/generate",{method:"POST",headers:{...a,"Content-Type":"application/json"},body:JSON.stringify(n)});return{timeline:o.timeline||{phases:[]},startDate:o.startDate,targetDeadline:o.targetDeadline}}}const w=new f;export{w as a,y as i};
