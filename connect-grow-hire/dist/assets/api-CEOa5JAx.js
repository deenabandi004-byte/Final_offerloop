const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CkUgwTeu.js","assets/vendor-react-CGb3T5FJ.js","assets/vendor-ClFF1JJD.js","assets/vendor-utils-B2rm_Apj.js","assets/vendor-dates-CPvpAlHY.js","assets/vendor-firebase-SSBCpsDT.js","assets/vendor-animations-CH_iu5NA.js","assets/index-Dxkivupg.css"])))=>i.map(i=>d[i]);
import{_ as l}from"./index-CkUgwTeu.js";const m="https://www.offerloop.ai/api";function y(c){return"error"in c&&typeof c.error=="string"}class p{async getIdToken(){try{const{auth:e}=await l(async()=>{const{auth:t}=await import("./index-CkUgwTeu.js").then(function(r){return r.j});return{auth:t}},__vite__mapDeps([0,1,2,3,4,5,6,7]));if(!e.currentUser)throw new Error("User not authenticated");return await e.currentUser.getIdToken()}catch(e){throw console.error("Error getting Firebase auth token:",e),new Error("Authentication required. Please sign in again.")}}async getAuthHeaders(){const e={"Content-Type":"application/json"};try{const t=await this.getIdToken();e.Authorization=`Bearer ${t}`}catch(t){throw console.error("Error getting Firebase auth headers:",t),t}return e}async makeRequest(e,t={}){var u;const r=`${m}${e}`,s=await fetch(r,t),i=s.headers.get("content-type")||"",o=s.headers.get("content-disposition")||"";if(i.includes("text/csv")||i.includes("application/pdf")||o.includes("attachment")){const d=await s.blob();if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);return d}const h=await s.text();let a={};if(h)try{a=JSON.parse(h)}catch{a={raw:h}}if(!s.ok){if(s.status===401&&a&&(a.needsAuth||a.require_reauth)){const n=new Error(a.message||a.error||"Authentication required");throw n.needsAuth=a.needsAuth||a.require_reauth,n.authUrl=a.authUrl,n.contacts=a.contacts,n.status=401,n}if(s.status===402&&a){const n=new Error(a.error||a.message||"Insufficient credits");throw n.status=402,n.error_code=a.error_code||"INSUFFICIENT_CREDITS",a.details&&(n.required=a.details.required,n.available=a.details.available,n.creditsNeeded=a.details.required,n.currentCredits=a.details.available),n}if(s.status===502&&a){const n=new Error(a.error||a.message||"The search service is temporarily unavailable. Please try again in a few minutes.");throw n.status=502,n.error_code=a.error_code||"EXTERNAL_API_ERROR",n.service=((u=a.details)==null?void 0:u.service)||"Search Service",n}const d=a&&(a.error||a.message||a.detail)||`HTTP ${s.status}: ${s.statusText}`;throw new Error(d)}return a??{}}async runFreeSearch(e){const t=await this.getAuthHeaders(),r={jobTitle:e.jobTitle,company:e.company,location:e.location,saveToDirectory:!1,userProfile:e.userProfile,careerInterests:e.careerInterests||[],collegeAlumni:e.collegeAlumni||"",batchSize:e.batchSize};return this.makeRequest("/free-run",{method:"POST",headers:t,body:JSON.stringify(r)})}async runProSearch(e){const t=await this.getIdToken(),r=new FormData;return r.append("jobTitle",e.jobTitle),r.append("company",e.company),r.append("location",e.location),r.append("resume",e.resume),r.append("saveToDirectory","false"),r.append("collegeAlumni",e.collegeAlumni||""),e.userProfile&&r.append("userProfile",JSON.stringify(e.userProfile)),e.careerInterests&&e.careerInterests.length>0&&r.append("careerInterests",JSON.stringify(e.careerInterests)),this.makeRequest("/pro-run",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:r})}async runFreeSearchCsv(e){const t=await this.getAuthHeaders(),r={jobTitle:e.jobTitle,company:e.company,location:e.location,saveToDirectory:!1,userProfile:e.userProfile,careerInterests:e.careerInterests||[],collegeAlumni:e.collegeAlumni||""};return this.makeRequest("/free-run-csv",{method:"POST",headers:t,body:JSON.stringify(r)})}async runProSearchCsv(e){const t=await this.getIdToken(),r=new FormData;return r.append("jobTitle",e.jobTitle),r.append("company",e.company),r.append("location",e.location),r.append("resume",e.resume),r.append("saveToDirectory","false"),r.append("collegeAlumni",e.collegeAlumni||""),e.userProfile&&r.append("userProfile",JSON.stringify(e.userProfile)),e.careerInterests&&e.careerInterests.length>0&&r.append("careerInterests",JSON.stringify(e.careerInterests)),this.makeRequest("/pro-run-csv",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:r})}async runBasicSearch(e){return console.warn("runBasicSearch is deprecated. Use runFreeSearch() instead."),this.runFreeSearch(e)}async runAdvancedSearch(e){return console.warn("runAdvancedSearch is deprecated. Redirecting to Free tier."),this.runFreeSearch(e)}async createCoffeeChatPrep(e){const t=await this.getAuthHeaders();return this.makeRequest("/coffee-chat-prep",{method:"POST",headers:t,body:JSON.stringify(e)})}async getCoffeeChatPrepStatus(e){const t=await this.getAuthHeaders();return this.makeRequest(`/coffee-chat-prep/${e}`,{method:"GET",headers:t})}async downloadCoffeeChatPDF(e){const t=await this.getAuthHeaders();return this.makeRequest(`/coffee-chat-prep/${e}/download`,{method:"GET",headers:t})}async getAllCoffeeChatPreps(){const e=await this.getAuthHeaders();return this.makeRequest("/coffee-chat-prep/all",{method:"GET",headers:e})}async getCoffeeChatHistory(e=10){const t=await this.getAuthHeaders();return this.makeRequest(`/coffee-chat-prep/history?limit=${e}`,{method:"GET",headers:t})}async generateInterviewPrep(e){const t=await this.getAuthHeaders();return this.makeRequest("/interview-prep/generate",{method:"POST",headers:t,body:JSON.stringify(e)})}async getInterviewPrepStatus(e){const t=await this.getAuthHeaders();return this.makeRequest(`/interview-prep/status/${e}`,{method:"GET",headers:t})}async downloadInterviewPrepPDF(e){const t=await this.getAuthHeaders();return this.makeRequest(`/interview-prep/download/${e}`,{method:"GET",headers:t})}async getInterviewPrepHistory(e=10){const t=await this.getAuthHeaders();return this.makeRequest(`/interview-prep/history?limit=${e}`,{method:"GET",headers:t})}async searchFirms(e,t=10){const r=await this.getAuthHeaders();return this.makeRequest("/firm-search/search",{method:"POST",headers:r,body:JSON.stringify({query:e,batchSize:t})})}async getFirmSearchHistory(e=10,t=!1){const r=await this.getAuthHeaders(),s=t?"&includeFirms=true":"";return(await this.makeRequest(`/firm-search/history?limit=${e}${s}`,{method:"GET",headers:r})).searches||[]}async getFirmSearchById(e){const t=await this.getAuthHeaders();try{const r=await this.makeRequest(`/firm-search/history/${e}`,{method:"GET",headers:t});return r.success&&r.search?{success:!0,firms:r.search.results||[],total:r.search.resultsCount||0,parsedFilters:r.search.parsedFilters}:null}catch(r){return console.error("Error getting firm search:",r),null}}async startGmailOAuth(){const e=await this.getAuthHeaders(),{authUrl:t}=await this.makeRequest("/google/oauth/start",{headers:e});return t}async gmailStatus(){const e=await this.getAuthHeaders();return this.makeRequest("/google/gmail/status",{headers:e})}async saveGmailDraft(e){const t=await this.getAuthHeaders();return this.makeRequest("/gmail/drafts",{method:"POST",headers:t,body:JSON.stringify(e)})}async getTierInfo(){const e=await this.getAuthHeaders();return this.makeRequest("/tier-info",{headers:e})}async checkCredits(){const e=await this.getAuthHeaders();return this.makeRequest("/check-credits",{headers:e})}async checkHealth(){return this.makeRequest("/health")}async deleteCoffeeChatPrep(e){const t=await this.getAuthHeaders();return this.makeRequest(`/coffee-chat-prep/${e}`,{method:"DELETE",headers:t})}async checkContactReplies(e){const t=await this.getAuthHeaders();return this.makeRequest(`/contacts/${e}/check-replies`,{method:"GET",headers:t})}async batchCheckReplies(e){const t=await this.getAuthHeaders();return this.makeRequest("/contacts/batch-check-replies",{method:"POST",headers:t,body:JSON.stringify({contactIds:e})})}async muteContactNotifications(e,t){const r=await this.getAuthHeaders();return this.makeRequest(`/contacts/${e}/mute-notifications`,{method:"POST",headers:r,body:JSON.stringify({muted:t})})}async generateReplyDraft(e){const t=await this.getAuthHeaders();return this.makeRequest(`/contacts/${e}/generate-reply`,{method:"POST",headers:t})}async getDashboardStats(){const e=await this.getAuthHeaders();return this.makeRequest("/dashboard/stats",{method:"GET",headers:e})}async getRecommendations(){const e=await this.getAuthHeaders();return this.makeRequest("/dashboard/recommendations",{method:"GET",headers:e})}async getFirmLocations(){const e=await this.getAuthHeaders();return this.makeRequest("/dashboard/firm-locations",{method:"GET",headers:e})}async getInterviewPrepStats(){const e=await this.getAuthHeaders();return this.makeRequest("/dashboard/interview-prep-stats",{method:"GET",headers:e})}async getOutboxThreads(){const e=await this.getAuthHeaders();return this.makeRequest("/outbox/threads",{method:"GET",headers:e})}async regenerateOutboxReply(e){const t=await this.getAuthHeaders();return this.makeRequest(`/outbox/threads/${e}/regenerate`,{method:"POST",headers:t,body:JSON.stringify({})})}downloadCsv(e,t="contacts.csv"){const r=window.URL.createObjectURL(e),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(r)}async generateTimeline(e,t=!1,r){const s=await this.getAuthHeaders(),i={prompt:e};t&&r&&(i.isUpdate=!0,i.existingTimeline=r);const o=await this.makeRequest("/timeline/generate",{method:"POST",headers:{...s,"Content-Type":"application/json"},body:JSON.stringify(i)});return{timeline:o.timeline||{phases:[]},startDate:o.startDate,targetDeadline:o.targetDeadline}}}const f=new p;export{f as a,y as i};
