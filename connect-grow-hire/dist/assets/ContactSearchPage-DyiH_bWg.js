const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CAu39nmG.js","assets/vendor-react-DiVfGd0B.js","assets/vendor-utils-B2rm_Apj.js","assets/vendor-dates-CPvpAlHY.js","assets/vendor-firebase-BQzy1uck.js","assets/vendor-animations-CH_iu5NA.js","assets/index-CxqPVdU5.css"])))=>i.map(i=>d[i]);
import{c as De,u as Ze,B as Z,a as Qe,t as b,d as ye,f as et,_ as ie,b as Ne,s as tt}from"./index-CAu39nmG.js";import{r as n,j as e,aE as Ue,aF as at,O as Ee,as as st,aq as Ae,u as rt,ay as nt,K as Se,a3 as ot,a0 as it}from"./vendor-react-DiVfGd0B.js";import{S as lt,A as ct,a as dt}from"./AppSidebar-W5X10pj_.js";import{T as mt,a as ut,b as Ce,c as _e}from"./tabs-LJZmQEhL.js";import{C as K,a as $e,b as Re,c as X}from"./card-BrbriW9G.js";import{S as ht}from"./ContactDirectory-bOgjhOP1.js";import{I as xt}from"./input-BxFVHUGk.js";import{C as ft,b as pt,d as gt,e as bt}from"./command-DINGhIMa.js";import{P as jt,a as vt,b as wt}from"./popover-Dm0PVhDh.js";import{a as ce,i as yt}from"./api-iiC4droA.js";import{f as ke}from"./firebaseApi-DgD_iVAL.js";import{T as Ie}from"./constants-BVoUACx7.js";import{P as Nt,e as Te,l as Fe}from"./PageHeaderActions-B-_H7UFk.js";import{d as Pe,e as St,r as Ct,l as _t,m as kt,u as It}from"./vendor-firebase-BQzy1uck.js";import{T as Tt}from"./textarea-CttOf0y-.js";import{L as Ft}from"./label-Do49BAWn.js";import{d as le,a as Pt}from"./analytics-BKO9ZQLz.js";const Le=n.forwardRef(({className:r,value:y,...v},E)=>e.jsx(Ue,{ref:E,className:De("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...v,children:e.jsx(at,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(y||0)}%)`}})}));Le.displayName=Ue.displayName;function Dt(r,y){const[v,E]=n.useState(r);return n.useEffect(()=>{const N=setTimeout(()=>{E(r)},y);return()=>{clearTimeout(N)}},[r,y]),v}const Ut=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",Et=(r,y,v=!0)=>{const[E,N]=n.useState([]),[z,m]=n.useState(!1),[c,w]=n.useState(null),f=Dt(y,300);return n.useEffect(()=>{if(!v||!f||f.length<2){N([]),w(null);return}(async()=>{m(!0),w(null);try{const x=await fetch(`${Ut}/api/autocomplete/${r}?query=${encodeURIComponent(f)}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!x.ok)throw new Error(`HTTP error! status: ${x.status}`);const C=await x.json();if(C.error)throw new Error(C.error);N(C.suggestions||[])}catch(x){console.error("Autocomplete error:",x),w(x instanceof Error?x.message:"Unknown error"),N([])}finally{m(!1)}})()},[r,f,v]),{suggestions:E,isLoading:z,error:c}},ne=({value:r,onChange:y,placeholder:v,dataType:E,disabled:N=!1,className:z})=>{const[m,c]=n.useState(!1),[w,f]=n.useState(r),F=n.useRef(null),{suggestions:x,isLoading:C,error:l}=Et(E,w,m);n.useEffect(()=>{f(r)},[r]);const B=S=>{const T=S.target.value;f(T),y(T),T.length>=2&&!N?c(!0):c(!1)},P=S=>{var T;f(S),y(S),c(!1),(T=F.current)==null||T.blur()},p=()=>{w.length>=2&&!N&&c(!0)},d=()=>{setTimeout(()=>c(!1),150)},oe=S=>{var T;S.key==="Escape"&&(c(!1),(T=F.current)==null||T.blur())},M=m&&!N&&w.length>=2,Q=C||x.length>0||!!l;return e.jsx("div",{className:"relative",children:e.jsxs(jt,{open:!!(M&&Q),children:[e.jsx(vt,{asChild:!0,children:e.jsx("div",{children:e.jsx(xt,{ref:F,value:w,onChange:B,onFocus:p,onBlur:d,onKeyDown:oe,placeholder:v,disabled:N,className:De(z,M&&"rounded-b-none")})})}),e.jsx(wt,{className:"w-full p-0 mt-0 rounded-t-none border-t-0",align:"start",side:"bottom",sideOffset:-1,onOpenAutoFocus:S=>S.preventDefault(),children:e.jsx(ft,{children:e.jsxs(pt,{className:"max-h-48",children:[C&&e.jsxs("div",{className:"flex items-center justify-center p-4 text-sm text-muted-foreground",children:[e.jsx(Ee,{className:"h-4 w-4 animate-spin mr-2"}),"Loading suggestions..."]}),l&&e.jsxs("div",{className:"p-4 text-sm text-destructive",children:["Error loading suggestions: ",l]}),!C&&!l&&x.length===0&&w.length>=2&&e.jsxs("div",{className:"p-4 text-sm text-muted-foreground",children:['No suggestions found for "',w,'"']}),!C&&!l&&x.length>0&&e.jsx(gt,{children:x.slice(0,8).map((S,T)=>e.jsx(bt,{value:S,onSelect:()=>P(S),className:"cursor-pointer hover:bg-secondary",children:e.jsx("span",{className:"truncate",children:S})},`${S}-${T}`))})]})})})]})})},At=["Find USC alumni in investment banking at Goldman in NYC","Software engineers at Google in San Francisco","Product managers at Meta in Seattle","Consultants at McKinsey who went to Harvard"],$t=({onSearchComplete:r,onSearchStart:y,userTier:v="free",userCredits:E=0})=>{const[N,z]=n.useState(""),[m,c]=n.useState(1),[w,f]=n.useState(!1),[F,x]=n.useState(null),{toast:C}=Ze(),l=n.useMemo(()=>{const p=v==="free"?3:v==="pro"?8:15,d=Math.floor((E??0)/15);return Math.min(p,d)},[v,E]);n.useEffect(()=>{m>l&&c(Math.max(1,l))},[l,m]);const B=async p=>{if(p.preventDefault(),!(!N.trim()||w)){f(!0),y==null||y(),x(null);try{const d=await ce.promptSearch(N.trim(),m);if("error"in d){C({title:"Search failed",description:d.error,variant:"destructive"}),f(!1);return}x(d),d.contacts.length===0?C({title:"No contacts found",description:"Try using broader search terms or removing some filters",variant:"destructive"}):C({title:"Search complete!",description:`Found ${d.contacts.length} contacts`}),r==null||r(d.contacts,d.parsed_query)}catch(d){console.error("Error running search:",d),C({title:"Error",description:d.message||"Failed to run search. Please try again.",variant:"destructive"})}finally{f(!1)}}},P=p=>{const d=[];return p.job_title&&d.push(p.job_title),p.company&&d.push(`at ${p.company}`),p.location&&d.push(`in ${p.location}`),p.school&&d.push(`(${p.school} alumni)`),d.join(" ")||"No filters extracted"};return e.jsx("div",{className:"w-full space-y-4",children:e.jsxs(K,{className:"w-full",children:[e.jsxs($e,{children:[e.jsxs(Re,{className:"text-xl flex items-center gap-2",children:[e.jsx(st,{className:"h-5 w-5 text-primary"}),"Prompt Search"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Describe who you want to reach in natural language"})]}),e.jsxs(X,{className:"space-y-6",children:[e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ft,{htmlFor:"prompt-input",className:"text-sm font-medium",children:"Search Prompt"}),e.jsx(Tt,{id:"prompt-input",placeholder:"e.g., Find USC alumni working as product managers at Google in San Francisco",value:N,onChange:p=>z(p.target.value),className:"min-h-[100px] resize-none",disabled:w})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Try these examples:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:At.map((p,d)=>e.jsx("button",{type:"button",onClick:()=>z(p),className:"text-xs px-3 py-1.5 rounded-full border border-border hover:border-primary/50 text-muted-foreground hover:text-foreground transition-colors",disabled:w,children:p},d))})]}),e.jsxs("div",{className:"col-span-1 lg:col-span-2 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Email Batch Size"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"- Choose how many contacts to generate per search"})]}),e.jsx("div",{className:"bg-muted/30 rounded-xl p-4 sm:p-6 border border-border shadow-lg",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 border border-blue-400/40 rounded-xl px-4 py-3 min-w-[60px] sm:min-w-[70px] text-center shadow-inner",children:e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-300 to-cyan-300 bg-clip-text text-transparent",children:m})}),e.jsx("div",{className:"flex-1 w-full sm:max-w-[320px] pt-2 sm:pt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"range",min:"1",max:l,value:m,onChange:p=>c(Number(p.target.value)),disabled:w||l<1,className:`w-full h-3 bg-gray-700/50 rounded-full appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed 
                          [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-7 [&::-webkit-slider-thumb]:h-7 
                          [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white
                          [&::-webkit-slider-thumb]:shadow-[0_0_20px_rgba(59,130,246,0.6)] 
                          [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-400
                          [&::-webkit-slider-thumb]:hover:shadow-[0_0_25px_rgba(59,130,246,0.8)] 
                          [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:duration-200
                          [&::-moz-range-thumb]:appearance-none [&::-moz-range-thumb]:w-7 [&::-moz-range-thumb]:h-7 
                          [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-white
                          [&::-moz-range-thumb]:shadow-[0_0_20px_rgba(59,130,246,0.6)] 
                          [&::-moz-range-thumb]:border-2 [&::-moz-range-thumb]:border-blue-400`,style:{background:`linear-gradient(to right, 
                            rgba(59, 130, 246, 0.8) 0%, 
                            rgba(96, 165, 250, 0.8) ${l>1?(m-1)/(l-1)*100:0}%, 
                            rgba(55, 65, 81, 0.3) ${l>1?(m-1)/(l-1)*100:0}%, 
                            rgba(55, 65, 81, 0.3) 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-3 font-medium",children:[e.jsx("span",{children:"1"}),e.jsx("span",{children:l})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-xl px-4 py-3 min-w-[80px] sm:min-w-[100px] w-full sm:w-auto border border-blue-400/20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-xl font-bold text-blue-600",children:m*15}),e.jsx("span",{className:"text-sm text-blue-600/70 ml-2",children:"credits"})]})})]})}),l<(v==="free"?3:v==="pro"?8:15)&&e.jsx("div",{className:"mt-4 bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-yellow-700 flex items-start gap-2",children:[e.jsx("span",{children:"âš ï¸"}),e.jsxs("span",{children:["Limited by available credits. Maximum: ",l," contacts."]})]})})]}),e.jsx(Z,{type:"submit",className:"w-full",disabled:!N.trim()||w,size:"lg",children:w?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"mr-2 h-4 w-4"}),"Search Contacts"]})})]}),F&&e.jsx("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg border border-border",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Searched for:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:P(F.parsed_query)}),F.count>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Found ",F.count," contact",F.count!==1?"s":""]})]})})]})]})})},ea=()=>{const{user:r,checkCredits:y,updateCredits:v}=Qe(),E=rt(),[N,z]=nt(),m=r||{credits:0,maxCredits:0,name:"User",email:"user@example.com",tier:"free"},c=n.useMemo(()=>{const t=m==null?void 0:m.tier;return t==="pro"||t==="elite"?t:"free"},[m==null?void 0:m.tier]);function w(t){return t&&Array.isArray(t.contacts)}const[f,F]=n.useState(""),[x,C]=n.useState(""),[l,B]=n.useState(""),[P,p]=n.useState(""),[d,oe]=n.useState(null),[M,Q]=n.useState(null),[S,T]=n.useState(null),[J,de]=n.useState(!1),[O,ee]=n.useState(null),[D,G]=n.useState(!1),[me,j]=n.useState(0),[H,q]=n.useState(!1),[te,ae]=n.useState([]),[ze,ue]=n.useState(null),he=te.length>0,[L,xe]=n.useState(1),R=n.useMemo(()=>{const t=c==="free"?3:c==="pro"?8:15,s=Math.floor((m.credits??0)/15);return Math.min(t,s)},[c,m.credits]);n.useEffect(()=>{L>R&&xe(Math.max(1,R))},[R,L]);const[V,fe]=n.useState(null),[Me,pe]=n.useState("contact-search"),[W,ge]=n.useState("traditional"),be=Ie[c]||Ie.free;n.useEffect(()=>{const t=N.get("company"),s=N.get("location");(t||s)&&(t&&C(t),s&&B(s),z({},{replace:!0}),b({title:"Search pre-filled",description:`Finding contacts at ${t||"this company"}`}))},[]);const Be=t=>Object.fromEntries(Object.entries(t).filter(([,s])=>s!==void 0)),je=n.useCallback(async()=>{if(!r)return null;try{if(r!=null&&r.uid){const a=await ke.getProfessionalInfo(r.uid);if(a)return{name:`${a.firstName||""} ${a.lastName||""}`.trim()||r.name||"",university:a.university||"",major:a.fieldOfStudy||"",year:a.graduationYear||"",graduationYear:a.graduationYear||"",degree:a.currentDegree||"",careerInterests:a.targetIndustries||[]}}const t=localStorage.getItem("professionalInfo"),s=localStorage.getItem("resumeData"),o=t?JSON.parse(t):{},u=s?JSON.parse(s):{};return{name:`${o.firstName||""} ${o.lastName||""}`.trim()||u.name||r.name||"",university:o.university||u.university||"",major:o.fieldOfStudy||u.major||"",year:o.graduationYear||u.year||"",graduationYear:o.graduationYear||u.year||"",degree:o.currentDegree||u.degree||"",careerInterests:o.targetIndustries||[]}}catch{return null}},[r]),se=async(t,s)=>{if(r)try{const o=new Date().toLocaleDateString("en-US"),u=t.map(a=>{const g=[a.City??"",a.State??""].filter(Boolean).join(", ")||a.location||s||"";return Be({firstName:a.FirstName??a.firstName??"",lastName:a.LastName??a.lastName??"",linkedinUrl:a.LinkedIn??a.linkedinUrl??"",email:a.Email??a.email??"",company:a.Company??a.company??"",jobTitle:a.Title??a.jobTitle??"",college:a.College??a.college??"",location:g,firstContactDate:o,status:"Not Contacted",lastContactDate:o,emailSubject:a.email_subject??a.emailSubject??void 0,emailBody:a.email_body??a.emailBody??void 0,gmailThreadId:a.gmailThreadId??a.gmail_thread_id??void 0,gmailMessageId:a.gmailMessageId??a.gmail_message_id??void 0,gmailDraftId:a.gmailDraftId??a.gmail_draft_id??void 0,gmailDraftUrl:a.gmailDraftUrl??a.gmail_draft_url??void 0,hasUnreadReply:!1,notificationsMuted:!1})});await ke.bulkCreateContacts(r.uid,u)}catch(o){throw o}},Oe=async()=>{try{if(!r)return!1;const{auth:t}=await ie(async()=>{const{auth:_}=await import("./index-CAu39nmG.js").then(function(A){return A.j});return{auth:_}},__vite__mapDeps([0,1,2,3,4,5,6])),s=t.currentUser;if(!s)return!1;const o=await s.getIdToken(!0),u=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",a=await fetch(`${u}/api/google/gmail/status`,{headers:{Authorization:`Bearer ${o}`}});return a.ok?!(await a.json()).connected:!0}catch{return!0}},Ge=async()=>{try{const{auth:t}=await ie(async()=>{const{auth:_}=await import("./index-CAu39nmG.js").then(function(A){return A.j});return{auth:_}},__vite__mapDeps([0,1,2,3,4,5,6])),s=t.currentUser;if(!s)return;const o=await s.getIdToken(!0),u=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",a=await fetch(`${u}/api/google/oauth/start`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!a.ok)return;const g=await a.json();g.authUrl&&(sessionStorage.setItem("gmail_oauth_return",window.location.pathname),window.location.href=g.authUrl)}catch{}},qe=async t=>{var U;const{auth:s}=await ie(async()=>{const{auth:I}=await import("./index-CAu39nmG.js").then(function(Y){return Y.j});return{auth:I}},__vite__mapDeps([0,1,2,3,4,5,6])),o=await((U=s.currentUser)==null?void 0:U.getIdToken(!0)),u=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",a=await je();let g=null;try{const I=localStorage.getItem("scout_fit_context");I&&(g=JSON.parse(I),console.log("[ContactSearch] Using fit context for email generation:",g))}catch(I){console.warn("[ContactSearch] Failed to parse fit context:",I)}const _=await fetch(`${u}/api/emails/generate-and-draft`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({contacts:t,resumeText:"",userProfile:a,careerInterests:(a==null?void 0:a.careerInterests)||[],fitContext:g})}),A=_.headers.get("content-type")||"",h=await _.text(),i=h?A.includes("application/json")?JSON.parse(h):{raw:h}:{};if(_.status===401){if(i!=null&&i.needsAuth&&(i!=null&&i.authUrl))return window.location.href=i.authUrl,null;throw new Error(i.error||"Gmail session expired â€” please reconnect.")}if(!_.ok)throw new Error(i.error||`HTTP ${_.status}: ${_.statusText}`);return i};n.useEffect(()=>{(async()=>{if(r)try{const s=await Oe();fe(!s)}catch{fe(!1)}})()},[r]),n.useEffect(()=>{try{const t=localStorage.getItem("scout_fit_context");if(t){const s=JSON.parse(t);ee(s)}}catch{}},[]);const Ve=(t,s,o)=>{F(t),s&&C(s),o&&B(o)};n.useEffect(()=>{},[f,x]);const ve=n.useCallback(async()=>{if(r!=null&&r.uid)try{const t=Pe(ye,"users",r.uid),s=await St(t);if(s.exists()){const o=s.data(),u=o.resumeUrl||null,a=o.resumeFileName||null;Q(u),T(a)}}catch(t){console.error("Failed to load saved resume:",t)}},[r==null?void 0:r.uid]);n.useEffect(()=>{ve()},[ve]);const we=async t=>{if(!(r!=null&&r.uid))throw new Error("User not authenticated");de(!0);try{const s=new FormData;s.append("resume",t);const o=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",u=Ne.currentUser?await Ne.currentUser.getIdToken():null,a=await fetch(`${o}/api/parse-resume`,{method:"POST",headers:u?{Authorization:`Bearer ${u}`}:{},body:s}),g=await a.json();if(!a.ok)throw new Error(g.error||"Failed to parse resume");const _=Date.now(),A=`resumes/${r.uid}/${_}-${t.name}`,h=Ct(tt,A);await _t(h,t);const i=await kt(h),U=Pe(ye,"users",r.uid);await It(U,{resumeUrl:i,resumeFileName:t.name,resumeUpdatedAt:new Date().toISOString(),resumeParsed:{name:g.data.name||"",university:g.data.university||"",major:g.data.major||"",year:g.data.year||""}}),Q(i),T(t.name),oe(t),b({title:"Resume saved",description:"Your resume has been uploaded and saved to your account."})}catch(s){const o=s instanceof Error?s.message:"Failed to save resume";throw b({title:"Upload failed",description:o,variant:"destructive"}),s}finally{de(!1)}},Ye=async t=>{var o;const s=(o=t.target.files)==null?void 0:o[0];if(s){if(s.type!=="application/pdf"){b({title:"Invalid file type",description:"Please upload a PDF file.",variant:"destructive"});return}if(s.size>10*1024*1024){b({title:"File Too Large",description:"Please upload a PDF smaller than 10MB.",variant:"destructive"});return}try{await we(s)}catch{}t.target.value=""}},Je=t=>{t.preventDefault(),t.stopPropagation()},He=t=>{t.preventDefault(),t.stopPropagation()},Ke=t=>{t.preventDefault(),t.stopPropagation()},Xe=async t=>{var o;t.preventDefault(),t.stopPropagation();const s=(o=t.dataTransfer.files)==null?void 0:o[0];if(s){if(s.type!=="application/pdf"){b({title:"Invalid file type",description:"Please upload a PDF file.",variant:"destructive"});return}if(s.size>10*1024*1024){b({title:"File Too Large",description:"Please upload a PDF smaller than 10MB.",variant:"destructive"});return}try{await we(s)}catch{}}},We=async()=>{var o,u;if(!f.trim()||!l.trim()){b({title:"Missing Required Fields",description:"Please enter both job title and location.",variant:"destructive"});return}if(!r){b({title:"Authentication Required",description:"Please sign in to search for contacts.",variant:"destructive"}),E("/signin");return}G(!0),j(10),q(!1);let t=null;const s=()=>{let a=10;t=setInterval(()=>{a<85&&(a+=Math.random()*5+2,a=Math.min(a,85),j(Math.floor(a)))},500)};try{s();const[a,g]=await Promise.all([je(),y?y():Promise.resolve(m.credits??0)]);if(j(20),g<15){t&&clearInterval(t),G(!1),j(0),b({title:"Insufficient Credits",description:`You have ${g} credits. You need at least 15 credits to search.`,variant:"destructive"});return}if(c==="pro"&&!d&&!M){t&&clearInterval(t),G(!1),j(0),b({title:"Resume Required",description:"Pro tier requires a resume upload for similarity matching.",variant:"destructive"});return}const _=async()=>{if(d)return d;if(M&&S){const h=await(await fetch(M)).blob();return new File([h],S,{type:"application/pdf"})}throw new Error("No resume available")};if(j(30),c==="free"||c==="elite"){const A={jobTitle:f.trim(),company:x.trim()||"",location:l.trim(),saveToDirectory:!1,userProfile:a,careerInterests:(a==null?void 0:a.careerInterests)||[],collegeAlumni:(P||"").trim(),batchSize:L};j(40);const h=await ce.runFreeSearch(A);if(!w(h)){t&&clearInterval(t),j(0),b({title:"Search Failed",description:(h==null?void 0:h.error)||"Please try again.",variant:"destructive"});return}t&&clearInterval(t),j(90);const i=h.contacts.length*15,U=Math.max(0,g-i);if(v&&await v(U).catch(()=>{}),j(100),ae(h.contacts),ue({successful_drafts:h.successful_drafts??0,total_contacts:h.contacts.length}),j(100),q(!0),le("contact_search","search",!0,{results_count:h.contacts.length,credits_spent:i,alumni_filter:!!(P||"").trim()}),r!=null&&r.uid&&h.contacts.length>0)try{const I=Te({jobTitle:f.trim(),company:x.trim()||void 0,location:l.trim(),college:P.trim()||void 0,contactCount:h.contacts.length});await Fe(r.uid,"contactSearch",I,{jobTitle:f.trim(),company:x.trim()||"",location:l.trim(),collegeAlumni:P.trim()||"",contactCount:h.contacts.length,tier:"free"})}catch{}try{await se(h.contacts,l.trim()),b({title:"Search Complete!",description:`Found ${h.contacts.length} contacts. Used ${i} credits. ${U} credits remaining.`,duration:5e3})}catch(I){console.error("Failed to save contacts:",I),b({title:"Search Complete!",description:`Found ${h.contacts.length} contacts. Used ${i} credits.`,variant:"destructive",duration:5e3})}}else if(c==="pro"){const A=await _(),h={jobTitle:f.trim(),company:x.trim()||"",location:l.trim(),resume:A,saveToDirectory:!1,userProfile:a,careerInterests:(a==null?void 0:a.careerInterests)||[],collegeAlumni:(P||"").trim(),batchSize:L};j(40);const i=await ce.runProSearch(h);if(yt(i)){t&&clearInterval(t),G(!1),j(0);const k=(o=i.error)!=null&&o.includes("Insufficient credits")?"insufficient_credits":"api_error";if(Pt("contact_search","search",k,i.error),(u=i.error)!=null&&u.includes("Insufficient credits")){b({title:"Insufficient Credits",description:i.error,variant:"destructive"}),y&&await y();return}b({title:"Search Failed",description:i.error||"Please try again.",variant:"destructive"});return}t&&clearInterval(t),j(90);const U=i.contacts.length*15,I=Math.max(0,g-U);if(v&&await v(I),ae(i.contacts),ue({successful_drafts:i.successful_drafts,total_contacts:i.contacts.length}),j(100),q(!0),le("contact_search","search",!0,{results_count:i.contacts.length,credits_spent:U,alumni_filter:!!(P||"").trim()}),r!=null&&r.uid&&i.contacts.length>0)try{const k=Te({jobTitle:f.trim(),company:x.trim()||void 0,location:l.trim(),college:P.trim()||void 0,contactCount:i.contacts.length});await Fe(r.uid,"contactSearch",k,{jobTitle:f.trim(),company:x.trim()||"",location:l.trim(),collegeAlumni:P.trim()||"",contactCount:i.contacts.length,tier:"pro"})}catch{}const Y=!!localStorage.getItem("scout_fit_context");let $=null;if(Y)try{$=JSON.parse(localStorage.getItem("scout_fit_context")||"{}"),ee($)}catch{}try{await qe(i.contacts),Y&&(localStorage.removeItem("scout_fit_context"),ee(null))}catch(k){if(k!=null&&k.needsAuth||k!=null&&k.require_reauth){const re=k.authUrl;if(re){window.location.href=re;return}}}try{await se(i.contacts,l.trim());const k=Y&&($!=null&&$.job_title)?`Found ${i.contacts.length} contacts. Generated targeted emails for ${$.job_title}${$.company?` at ${$.company}`:""} using your fit analysis. Used ${U} credits. ${I} credits remaining.`:`Found ${i.contacts.length} contacts. Generated general networking emails. Used ${U} credits. ${I} credits remaining.`;b({title:Y&&($!=null&&$.job_title)?"ðŸŽ¯ Targeted Search Complete!":"Search Complete!",description:k,duration:7e3})}catch{b({title:"Search Complete!",description:`Found ${i.contacts.length} contacts. Used ${U} credits.`,variant:"destructive",duration:5e3})}}}catch(a){if(t&&clearInterval(t),a!=null&&a.needsAuth||a!=null&&a.require_reauth){const g=a.authUrl;if(g){if(b({title:"Gmail Connection Expired",description:a.message||"Please reconnect your Gmail account to create drafts.",variant:"destructive",duration:5e3}),a.contacts&&a.contacts.length>0)try{await se(a.contacts,l.trim())}catch(_){console.error("Failed to save contacts before redirect:",_)}window.location.href=g;return}}b({title:"Search Failed",description:a instanceof Error?a.message:"Please try again.",variant:"destructive",duration:5e3}),q(!1),j(0)}finally{t&&clearInterval(t),G(!1),H?setTimeout(()=>{j(0),q(!1)},2e3):setTimeout(()=>j(0),500)}};return e.jsx(lt,{children:e.jsxs("div",{className:"flex min-h-screen w-full bg-transparent text-foreground",children:[e.jsx(ct,{}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("header",{className:"h-16 flex items-center justify-between border-b border-gray-100/30 px-6 bg-transparent shadow-sm relative z-20",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(dt,{className:"text-foreground hover:bg-secondary"}),e.jsx("h1",{className:"text-xl font-semibold",children:"Contact Search"})]}),e.jsx(Nt,{onJobTitleSuggestion:Ve})]}),e.jsx("main",{className:"p-8 bg-transparent",children:e.jsx("div",{className:"max-w-5xl mx-auto",children:e.jsxs(mt,{value:Me,onValueChange:pe,className:"w-full",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs(ut,{className:"h-14 tabs-container-gradient border border-border grid grid-cols-2 max-w-lg w-full rounded-xl p-1 bg-white",children:[e.jsxs(Ce,{value:"contact-search",className:"h-12 font-medium text-base data-[state=active] data-[state=active]:text-white data-[state=inactive]:text-muted-foreground transition-all",children:[e.jsx(Ae,{className:"h-5 w-5 mr-2"}),"Contact Search"]}),e.jsxs(Ce,{value:"contact-library",className:"h-12 font-medium text-base data-[state=active] data-[state=active]:text-white data-[state=inactive]:text-muted-foreground transition-all",children:[e.jsx(Se,{className:"h-5 w-5 mr-2"}),"Contact Library"]})]})}),e.jsxs(_e,{value:"contact-search",className:"mt-6",children:[e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsxs("div",{className:"inline-flex rounded-lg border border-border bg-muted p-1",children:[e.jsx("button",{onClick:()=>ge("traditional"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${W==="traditional"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"ðŸ“‹ Traditional Search"}),e.jsx("button",{onClick:()=>ge("prompt"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${W==="prompt"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"âœ¨ Prompt Search"})]})}),W==="prompt"&&e.jsx("div",{className:"mb-6",children:e.jsx($t,{onSearchComplete:(t,s)=>{ae(t),q(!0),j(100),G(!1);const o=(s==null?void 0:s.location)||"";se(t,o);const u=t.length*15;le("contact_search","search",!0,{results_count:t.length,credits_spent:u,alumni_filter:!!((s==null?void 0:s.school)||"").trim()})},onSearchStart:()=>{G(!0),q(!1),ae([]),j(0)},userTier:c,userCredits:m.credits??0})}),W==="traditional"&&e.jsxs(e.Fragment,{children:[O&&O.job_title&&e.jsx(K,{className:"mb-6 bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200",children:e.jsx(X,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 text-lg",children:"ðŸŽ¯"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900",children:"Targeted Email Generation Active"}),e.jsxs("p",{className:"text-xs text-blue-700",children:["Emails will be tailored for ",e.jsx("strong",{children:O.job_title}),O.company?` at ${O.company}`:"",O.score?` (${O.score}% fit match)`:""]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Includes your strengths, talking points, and role-specific insights"})]})]}),e.jsx(Z,{onClick:()=>{localStorage.removeItem("scout_fit_context"),ee(null),b({title:"Fit context cleared",description:"Emails will now use general networking format"})},variant:"outline",size:"sm",className:"bg-white border-blue-300 text-blue-700 hover:bg-blue-50",children:"Clear"})]})})}),e.jsx(K,{className:"mb-6 bg-white border-border",children:e.jsx(X,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${V?"bg-blue-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:V?"Gmail Connected":"Gmail Not Connected"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:V?"Email drafts will be created in your Gmail":"Connect Gmail to create email drafts automatically"})]})]}),e.jsx(Z,{onClick:()=>Ge(),variant:V?"outline":"default",size:"sm",className:V?"bg-white border border-gray-200 text-gray-700 hover:bg-gray-50":" text-white shadow-sm",style:V?void 0:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:V?"Reconnect":"Connect Gmail"})]})})}),e.jsxs(K,{className:"bg-white border-border",children:[e.jsx($e,{className:"border-b border-border",children:e.jsxs(Re,{className:"text-xl text-foreground",children:["Professional Search Filters",e.jsx("span",{className:"text-sm text-muted-foreground",children:"- I want to network with..."})]})}),e.jsxs(X,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Job Title ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{value:f,onChange:F,placeholder:"e.g. Analyst, unsure of exact title in company? Ask Scout",dataType:"job_title",disabled:D,className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-purple-500 hover:border-purple-400 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-foreground",children:"Company"}),e.jsx(ne,{value:x,onChange:C,placeholder:"e.g. Google, Meta, or any preferred firm",dataType:"company",disabled:D,className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-purple-500 hover:border-purple-400 transition-colors"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Location ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(ne,{value:l,onChange:B,placeholder:"e.g. Los Angeles, CA, New York, NY, city of office",dataType:"location",disabled:D,className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-purple-500 hover:border-purple-400 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-foreground",children:"College Alumni"}),e.jsx(ne,{value:P,onChange:p,placeholder:"e.g. Stanford, USC, preferred college they attended",dataType:"school",disabled:D,className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-purple-500 hover:border-purple-400 transition-colors"})]})]}),e.jsxs("div",{className:"col-span-1 lg:col-span-2 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Email Batch Size"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"- Choose how many contacts to generate per search"})]}),e.jsx("div",{className:"bg-muted/30 rounded-xl p-4 sm:p-6 border border-border shadow-lg",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 border border-blue-400/40 rounded-xl px-4 py-3 min-w-[60px] sm:min-w-[70px] text-center shadow-inner",children:e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-300 to-cyan-300 bg-clip-text text-transparent",children:L})}),e.jsx("div",{className:"flex-1 w-full sm:max-w-[320px] pt-2 sm:pt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"range",min:"1",max:R,value:L,onChange:t=>xe(Number(t.target.value)),disabled:D||R<1,className:`w-full h-3 bg-gray-700/50 rounded-full appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed 
                                    [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-7 [&::-webkit-slider-thumb]:h-7 
                                    [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white
                                    [&::-webkit-slider-thumb]:shadow-[0_0_20px_rgba(59,130,246,0.6)] 
                                    [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-400
                                    [&::-webkit-slider-thumb]:hover:shadow-[0_0_25px_rgba(59,130,246,0.8)] 
                                    [&::-webkit-slider-thumb]:transition-all [&::-webkit-slider-thumb]:duration-200
                                    [&::-moz-range-thumb]:appearance-none [&::-moz-range-thumb]:w-7 [&::-moz-range-thumb]:h-7 
                                    [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-white
                                    [&::-moz-range-thumb]:shadow-[0_0_20px_rgba(59,130,246,0.6)] 
                                    [&::-moz-range-thumb]:border-2 [&::-moz-range-thumb]:border-blue-400`,style:{background:`linear-gradient(to right, 
                                      rgba(59, 130, 246, 0.8) 0%, 
                                      rgba(96, 165, 250, 0.8) ${(L-1)/(R-1)*100}%, 
                                      rgba(55, 65, 81, 0.3) ${(L-1)/(R-1)*100}%, 
                                      rgba(55, 65, 81, 0.3) 100%)`}}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-3 font-medium",children:[e.jsx("span",{children:"1"}),e.jsx("span",{children:R})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-xl px-4 py-3 min-w-[80px] sm:min-w-[100px] w-full sm:w-auto border border-blue-400/20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-xl font-bold text-blue-600",children:L*15}),e.jsx("span",{className:"text-sm text-blue-600/70 ml-2",children:"credits"})]})})]})}),R<(c==="free"?3:c==="pro"?8:15)&&e.jsx("div",{className:"mt-4 bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-yellow-700 flex items-start gap-2",children:[e.jsx("span",{children:"Warning"}),e.jsxs("span",{children:["Limited by available credits. Maximum: ",R," contacts."]})]})})]}),(c==="free"||c==="pro"||c==="elite")&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Resume ",c==="pro"&&e.jsx("span",{className:"text-destructive",children:"*"}),c==="pro"&&" (Required for Pro tier AI similarity matching)",c!=="pro"&&" (Optional - helps with personalized matching)"]}),M&&S?e.jsx("div",{className:"border-2 border-dashed border-green-500/50 rounded-lg p-4 bg-green-500/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Se,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:S}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Resume saved to your account"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Z,{type:"button",variant:"outline",size:"sm",onClick:()=>{const t=document.getElementById("resume-upload");t==null||t.click()},disabled:D||J,children:J?"Uploading...":"Change"})})]})}):e.jsxs("div",{className:"border-2 border-dashed border-input rounded-lg p-6 text-center hover:border-purple-400 transition-colors bg-muted/30 cursor-pointer",onDragOver:Je,onDragEnter:He,onDragLeave:Ke,onDrop:Xe,onClick:()=>{if(!D&&!J){const t=document.getElementById("resume-upload");t==null||t.click()}},children:[e.jsx("input",{type:"file",accept:".pdf",onChange:Ye,className:"hidden",id:"resume-upload",disabled:D||J}),e.jsxs("div",{className:`${D||J?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(ot,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-foreground mb-1 font-medium",children:J?"Uploading resume...":"Drag and drop your resume here, or click to upload"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PDF only, max 10MB"})]})]})]}),e.jsxs("div",{className:"space-y-4 mt-8",children:[e.jsx(Z,{onClick:We,disabled:!f.trim()||!l.trim()||D||c==="pro"&&!d&&!M||(m.credits??0)<15,size:"lg",className:" text-white font-medium px-8 transition-all hover:scale-105 shadow-sm",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:D?"Searching...":"Find Contacts"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"h-4 w-4"}),e.jsxs("span",{children:["Up to ",be.maxContacts," contacts + emails"]})]}),e.jsx("span",{className:"text-muted-foreground",children:"â€¢"}),e.jsx("span",{children:"Auto-saved to Contact Library"})]})]}),(D||H)&&e.jsx(K,{className:"mt-6 bg-white border-border",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-foreground",children:H?e.jsx("span",{className:"text-green-600 font-semibold",children:"Search completed successfully!"}):`Searching with ${be.name} tier...`}),e.jsxs("span",{className:H?"text-green-600 font-bold":"text-primary",children:[me,"%"]})]}),e.jsx(Le,{value:me,className:"h-2"}),H&&e.jsx("div",{className:"mt-2 text-sm text-green-600",children:"Check your Contact Library to view and manage your new contacts."})]})})}),D&&!he&&e.jsx(K,{className:"mt-6 bg-white border-border",children:e.jsx(X,{className:"p-6",children:e.jsx(et,{variant:"contacts",count:3})})}),H&&te.length===0&&e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 border-2 border-yellow-500/50 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"text-base font-semibold text-yellow-700",children:"No Contacts Found"})}),e.jsxs("div",{className:"text-sm text-yellow-700 mt-2",children:[e.jsx("p",{className:"mb-2",children:"The search criteria may be too restrictive. Try:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:'Using a broader job title (e.g., "analyst" instead of "investment banking analyst")'}),e.jsx("li",{children:"Removing the company filter"}),e.jsx("li",{children:"Using a broader location (e.g., just the state instead of city)"}),e.jsx("li",{children:"Removing the school filter if searching for alumni"})]}),W==="prompt"&&e.jsx("p",{className:"mt-3 text-xs text-yellow-600",children:"ðŸ’¡ Tip: Edit the filters in the confirmation screen to make them less specific"})]})]}),he&&ze&&e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-green-500/10 to-blue-500/10 border-2 border-green-500/50 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"text-base font-semibold text-green-700",children:"Search Completed Successfully!"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded p-2 border border-blue-200/50",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:te.length}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Contacts Found"})]}),e.jsxs("div",{className:"bg-blue-50 rounded p-2 border border-blue-200/50",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:te.length}),e.jsx("div",{className:"text-xs text-blue-600/70",children:"Email Drafts"})]})]}),e.jsxs("div",{className:"text-sm text-blue-700 mt-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"Saved"}),"All contacts saved to your Contact Library"]}),e.jsx("button",{onClick:()=>pe("contact-library"),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 underline",children:"View in Contact Library"})]})]})]})]})]}),e.jsx(_e,{value:"contact-library",className:"mt-6",children:e.jsx(ht,{})})]})})})]})]})})};export{ea as default};
