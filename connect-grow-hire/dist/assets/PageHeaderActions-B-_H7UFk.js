import{f as E}from"./firebaseApi-DgD_iVAL.js";import{T as J,d as W,e as K}from"./vendor-firebase-BQzy1uck.js";import{r as x,j as e,as as G,O as I,at as U,ao as V,u as q,aI as Q,Y as Z}from"./vendor-react-DiVfGd0B.js";import{B as Y,a as ee,d as te}from"./index-CAu39nmG.js";import{I as se}from"./input-BxFVHUGk.js";async function ue(a){try{const i=await E.getActivities(a,100),d=new Date;d.setDate(d.getDate()-7);const h=J.fromDate(d),l=i.filter(r=>{if(!r.timestamp)return!1;const m=r.timestamp.toMillis?r.timestamp.toMillis():r.timestamp,y=h.toMillis();return m>=y}),f={contactsGenerated:0,firmsSearched:0,coffeeChatsCreated:0,interviewPrepsCreated:0,totalActivities:l.length};return l.forEach(r=>{switch(r.type){case"contactSearch":f.contactsGenerated++;break;case"firmSearch":f.firmsSearched++;break;case"coffeePrep":f.coffeeChatsCreated++;break;case"interviewPrep":f.interviewPrepsCreated++;break}}),f}catch(i){return console.error("Error calculating weekly summary:",i),{contactsGenerated:0,firmsSearched:0,coffeeChatsCreated:0,interviewPrepsCreated:0,totalActivities:0}}}async function ae(a){try{const i=await E.getActivities(a,200);if(i.length===0)return{currentStreak:0,longestStreak:0,lastActivityDate:null};const d=new Map;i.forEach(b=>{if(!b.timestamp)return;const j=(b.timestamp.toMillis?new Date(b.timestamp.toMillis()):new Date(b.timestamp)).toISOString().split("T")[0];d.set(j,!0)});const h=Array.from(d.keys()).sort().reverse();if(h.length===0)return{currentStreak:0,longestStreak:0,lastActivityDate:null};let l=0;const f=new Date;f.setHours(0,0,0,0);let r=new Date(f);for(let b=0;b<h.length;b++){const v=h[b];new Date(v).setHours(0,0,0,0);const C=r.toISOString().split("T")[0];if(v===C)l++,r.setDate(r.getDate()-1);else{if(b===0&&v!==C){const M=new Date(f);M.setDate(M.getDate()-1);const _=M.toISOString().split("T")[0];if(v===_){l=1,r.setDate(r.getDate()-1);continue}}break}}let m=1,y=1;for(let b=1;b<h.length;b++){const v=new Date(h[b-1]),j=new Date(h[b]);Math.floor((v.getTime()-j.getTime())/(1e3*60*60*24))===1?(y++,m=Math.max(m,y)):y=1}return{currentStreak:l,longestStreak:m,lastActivityDate:h[0]||null}}catch(i){return console.error("Error calculating streak:",i),{currentStreak:0,longestStreak:0,lastActivityDate:null}}}async function he(a,i){try{let d=0;const h=i.startDate.toMillis(),l=i.endDate.toMillis();switch(i.type){case"contacts":{d=(await E.getContacts(a)).filter(m=>{if(!m.createdAt)return!1;const y=new Date(m.createdAt).getTime();return y>=h&&y<=l}).length;break}case"firms":{d=(await E.getActivities(a,100)).filter(m=>{if(m.type!=="firmSearch"||!m.timestamp)return!1;const y=m.timestamp.toMillis?m.timestamp.toMillis():m.timestamp;return y>=h&&y<=l}).length;break}case"coffeeChats":{d=(await E.getActivities(a,100)).filter(m=>{if(m.type!=="coffeePrep"||!m.timestamp)return!1;const y=m.timestamp.toMillis?m.timestamp.toMillis():m.timestamp;return y>=h&&y<=l}).length;break}case"outreach":{d=(await E.getContacts(a)).filter(m=>{if(!m.firstContactDate||m.status==="Not Contacted")return!1;const y=new Date(m.firstContactDate).getTime();return y>=h&&y<=l}).length;break}}const f=i.target>0?Math.min(100,d/i.target*100):0;return{goal:i,current:d,target:i.target,percentage:f}}catch(d){return console.error("Error calculating goal progress:",d),{goal:i,current:0,target:i.target,percentage:0}}}function fe(){const a=new Date;return new Date(a.getFullYear(),a.getMonth(),1),new Date(a.getFullYear(),a.getMonth()+1,0,23,59,59),[{type:"contacts",target:50,period:"month"},{type:"firms",target:20,period:"month"},{type:"coffeeChats",target:10,period:"month"}]}async function xe(a,i,d,h){try{console.log("ðŸ“ activityLogger.logActivity called:",{userId:a,type:i,summary:d}),await E.logActivity(a,i,d,h),console.log("âœ… activityLogger: Activity logged successfully");try{const l=await ae(a),f=new Date().toISOString().split("T")[0];l.lastActivityDate&&(await E.updateUserStreak(a,{currentStreak:l.currentStreak,longestStreak:Math.max(l.currentStreak,l.longestStreak),lastActivityDate:l.lastActivityDate}),console.log("âœ… Streak updated:",l))}catch(l){console.error("âš ï¸ Failed to update streak (non-critical):",l)}}catch(l){console.error("âŒ activityLogger: Failed to log activity:",l)}}function pe(a){const i=[];return a.jobTitle&&i.push(a.jobTitle),a.company&&i.push(`at ${a.company}`),a.location&&i.push(`in ${a.location}`),a.college&&i.push(`who attended ${a.college}`),`${i.length>0?i.join(" "):"contacts"} â€“ Generated ${a.contactCount} contacts`}function ge(a){return a.contactName&&a.company?`Created coffee chat prep for ${a.contactName} at ${a.company}`:a.contactName?`Created coffee chat prep for ${a.contactName}`:"Created coffee chat prep"}function ye(a){return a.roleTitle&&a.company?`Created interview prep for ${a.roleTitle} at ${a.company}`:a.roleTitle?`Created interview prep for ${a.roleTitle}`:"Created interview prep"}const H=window.location.hostname==="localhost"?"http://localhost:5001":"https://www.offerloop.ai",ne=a=>{if(!a)return a;const i=["Software Engineer","Software Developer","Engineer","Product Manager","Program Manager","Project Manager","Data Scientist","Data Analyst","Data Engineer","Investment Banking Analyst","Investment Banker","Financial Analyst","Business Analyst","Analyst","Consultant","Associate","Manager","Director","Designer","Researcher","Scientist","Account Executive","Sales Representative","Marketing Manager","Marketing Specialist","Operations Manager","Operations Analyst","HR Manager","Recruiter","Talent Acquisition","Attorney","Lawyer","Counsel","Accountant","Controller","Auditor"],d=["Senior","Staff","Principal","Lead","Junior","Associate","Vice President","VP"],h=a.toLowerCase();let l="";for(const r of i)if(h.includes(r.toLowerCase())){l=r;break}if(!l){if(a.length>40){const r=a.split(/[-â€“â€”,&]/),m=r[r.length-1].trim();if(m.length>3)return m}return a}let f="";for(const r of d)if(h.includes(r.toLowerCase())){f=r;break}return f&&!l.toLowerCase().includes(f.toLowerCase())?`${f} ${l}`:l},ie=({onJobTitleSuggestion:a,userResume:i})=>{const[d,h]=x.useState([]),[l,f]=x.useState(""),[r,m]=x.useState(!1),[y,b]=x.useState({}),v=x.useRef(null),j=x.useRef(null),[C,M]=x.useState(null),[_,T]=x.useState({}),[S,$]=x.useState(null);x.useEffect(()=>{var s;(s=v.current)==null||s.scrollIntoView({behavior:"smooth"})},[d]);const F=async()=>{var n;if(!l.trim()||r)return;const s={id:`user-${Date.now()}`,role:"user",content:l.trim(),timestamp:new Date};h(u=>[...u,s]),f(""),m(!0);try{const c=await(await fetch(`${H}/api/scout/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s.content,context:{...y,user_resume:i}})})).json();c.context&&b(c.context);const t={id:`assistant-${Date.now()}`,role:"assistant",content:c.message,fields:c.fields,jobListings:c.job_listings,fitAnalysis:c.fit_analysis,timestamp:new Date};if(c.job_listings&&c.job_listings.length>0&&console.log("[Scout] Job listings received:",c.job_listings.map(o=>({title:o.title,company:o.company,url:o.url,hasUrl:!!o.url}))),h(o=>[...o,t]),c.fields){const{job_title:o,company:A,location:p}=c.fields;(o||A||p)&&a&&a(o||"",A||void 0,p||void 0)}}catch(u){console.error("[Scout] Error:",u),h(c=>[...c,{id:`error-${Date.now()}`,role:"assistant",content:"Oops! I ran into an issue. Please try again or rephrase your message.",timestamp:new Date}])}finally{m(!1),(n=j.current)==null||n.focus()}},P=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),F())},R=s=>{if(a){const n=ne(s.title);console.log("[Scout] Simplified job title:",s.title,"â†’",n),a(n,s.company,s.location||void 0)}},O=async(s,n)=>{if(console.log("[Scout] analyzeJob called",{jobId:n,job:s,hasResume:!!i}),_[n]){console.log("[Scout] Analysis already exists, toggling expand"),$(S===n?null:n);return}if(!i){console.warn("[Scout] Cannot analyze job without resume"),alert("Please upload your resume in Account Settings to use job fit analysis.");return}M(n),console.log("[Scout] Starting analysis for job:",s.title);try{const u=await fetch(`${H}/api/scout/analyze-job`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({job:s,user_resume:i})});if(console.log("[Scout] Analysis response status:",u.status),!u.ok){const t=await u.text();throw console.error("[Scout] Analysis failed with status:",u.status,t),new Error(`Analysis failed: ${u.status} ${t}`)}const c=await u.json();if(console.log("[Scout] Analysis response:",c),console.log("[Scout] Response status:",c.status),console.log("[Scout] Has analysis:",!!c.analysis),console.log("[Scout] Analysis keys:",c.analysis?Object.keys(c.analysis):"N/A"),c.status==="ok"&&c.analysis){const t={...c.analysis};typeof t.score!="number"&&(t.score=50),t.match_level||(t.match_level="moderate"),t.pitch||(t.pitch=""),Array.isArray(t.talking_points)||(t.talking_points=[]),Array.isArray(t.keywords_to_use)||(t.keywords_to_use=[]),Array.isArray(t.strengths)?t.strengths=t.strengths.map(o=>typeof o=="string"?{point:o,evidence:""}:typeof o=="object"&&o!==null?{point:o.point||o.strength||String(o),evidence:o.evidence||o.proof||""}:{point:String(o),evidence:""}):t.strengths=[],Array.isArray(t.gaps)?t.gaps=t.gaps.map(o=>typeof o=="string"?{gap:o,mitigation:""}:typeof o=="object"&&o!==null?{gap:o.gap||o.weakness||String(o),mitigation:o.mitigation||o.solution||""}:{gap:String(o),mitigation:""}):t.gaps=[],console.log("[Scout] Normalized analysis:",t),T(o=>({...o,[n]:t})),$(n),console.log("[Scout] Analysis saved and expanded")}else{console.error("[Scout] Analysis response missing data:",c);const t=c.message||"Unknown error";alert(`Failed to analyze job fit: ${t}`)}}catch(u){console.error("[Scout] Analysis failed:",u),alert("Failed to analyze job fit. Please try again.")}finally{M(null)}},w=s=>s.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\n/g,"<br />"),g=async s=>{var n,u,c,t,o;if(s==="paste-url")f("Paste job URL here..."),(n=j.current)==null||n.focus(),(u=j.current)==null||u.select();else if(s==="find-jobs-resume"){const A="Find jobs that fit my resume";f(A);const p={id:`user-${Date.now()}`,role:"user",content:A,timestamp:new Date};h(k=>[...k,p]),f(""),m(!0);try{const N=await(await fetch(`${H}/api/scout/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:A,context:{...y,user_resume:i}})})).json();N.context&&b(N.context);const B={id:`assistant-${Date.now()}`,role:"assistant",content:N.message,fields:N.fields,jobListings:N.job_listings,fitAnalysis:N.fit_analysis,timestamp:new Date};if(N.job_listings&&N.job_listings.length>0&&console.log("[Scout] Job listings received:",N.job_listings.map(D=>({title:D.title,company:D.company,url:D.url,hasUrl:!!D.url}))),h(D=>[...D,B]),N.fields){const{job_title:D,company:L,location:z}=N.fields;(D||L||z)&&a&&a(D||"",L||void 0,z||void 0)}}catch(k){console.error("[Scout] Error:",k),h(N=>[...N,{id:`error-${Date.now()}`,role:"assistant",content:"Oops! I ran into an issue. Please try again or rephrase your message.",timestamp:new Date}])}finally{m(!1),(c=j.current)==null||c.focus()}}else s==="ask-company"&&(f("Ask about a company..."),(t=j.current)==null||t.focus(),(o=j.current)==null||o.select())};return e.jsxs("div",{className:"flex flex-col h-full bg-white",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[d.length===0&&e.jsx("div",{className:"mt-3 mx-4 p-3 rounded-2xl bg-[#F5F7FF]",children:e.jsx("p",{className:"text-sm text-slate-800",children:"Hey! I'm Scout. Paste a job posting URL or describe a role and I'll fill in your search filters for you."})}),d.length===0&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 px-4",children:[e.jsx("button",{onClick:()=>g("paste-url"),className:"inline-flex items-center px-3 py-1.5 rounded-full bg-white border border-slate-200 text-xs font-medium text-slate-700 hover:bg-slate-50 cursor-pointer transition-colors",children:"Paste job URL"}),e.jsx("button",{onClick:()=>g("find-jobs-resume"),className:"inline-flex items-center px-3 py-1.5 rounded-full bg-white border border-slate-200 text-xs font-medium text-slate-700 hover:bg-slate-50 cursor-pointer transition-colors",children:"Find jobs that fit my resume"}),e.jsx("button",{onClick:()=>g("ask-company"),className:"inline-flex items-center px-3 py-1.5 rounded-full bg-white border border-slate-200 text-xs font-medium text-slate-700 hover:bg-slate-50 cursor-pointer transition-colors",children:"Ask about a company"})]}),e.jsxs("div",{className:"px-4 py-4 space-y-4",children:[d.map(s=>e.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] rounded-2xl p-3 ${s.role==="user"?"text-white":"bg-[#F5F7FF] text-slate-800"}`,style:s.role==="user"?{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"}:void 0,children:[e.jsx("div",{className:"text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:w(s.content)}}),s.fields&&Object.keys(s.fields).length>0&&e.jsxs("div",{className:"mt-3 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-blue-700 text-xs font-medium",children:[e.jsx(G,{className:"h-3 w-3"}),"Search fields updated!"]}),e.jsx("div",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded",title:"Fields optimized for better search results",children:"âœ¨ Optimized"})]}),e.jsxs("div",{className:"text-xs text-blue-600 space-y-0.5",children:[s.fields.job_title&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Title:"}),e.jsx("span",{children:s.fields.job_title})]}),s.fields.company&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Company:"}),e.jsx("span",{children:s.fields.company})]}),s.fields.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Location:"}),e.jsx("span",{children:s.fields.location})]})]})]}),s.fitAnalysis&&e.jsxs("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsx("div",{className:"text-xs font-semibold text-amber-900 mb-2",children:"ðŸŽ¯ Job Fit Analysis"}),s.fitAnalysis.strengths&&s.fitAnalysis.strengths.length>0&&e.jsx("div",{className:"mb-2",children:s.fitAnalysis.strengths.map((n,u)=>e.jsxs("div",{className:"text-xs text-amber-800 mb-1",children:["âœ… ",n]},u))}),s.fitAnalysis.gaps&&s.fitAnalysis.gaps.length>0&&e.jsx("div",{className:"mb-2",children:s.fitAnalysis.gaps.map((n,u)=>e.jsxs("div",{className:"text-xs text-amber-700 mb-1",children:["âš ï¸ ",n]},u))}),s.fitAnalysis.angles&&s.fitAnalysis.angles.length>0&&e.jsxs("div",{className:"text-xs text-amber-800 font-medium mt-2",children:["ðŸ’¡ ",e.jsx("strong",{children:"Angle:"})," ",s.fitAnalysis.angles[0]]}),s.fitAnalysis.overall_score!==void 0&&e.jsxs("div",{className:"text-xs text-amber-900 font-medium mt-2",children:["Overall Fit: ",s.fitAnalysis.overall_score,"/100"]})]}),s.jobListings&&s.jobListings.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Click to use for search:"}),s.jobListings.slice(0,5).map((n,u)=>{const c=`${s.id}-job-${u}`,t=_[c],o=S===c,A=C===c;return e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{onClick:()=>R(n),className:"flex-1 text-left min-w-0 cursor-pointer",children:[e.jsx("div",{className:"text-sm font-medium text-slate-900",children:n.title}),e.jsxs("div",{className:"text-xs text-slate-500",children:[n.company,n.location&&` â€¢ ${n.location}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i?e.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),console.log("[Scout] Analyze Fit button clicked",{jobId:c,job:n}),O(n,c)},disabled:A,className:`px-3 py-1.5 text-xs font-medium rounded transition-all whitespace-nowrap cursor-pointer ${t?"bg-green-50 text-green-700 border border-green-200 hover:bg-green-100":"bg-slate-100 text-slate-600 hover:bg-slate-200"} ${A?"opacity-50 cursor-not-allowed":""}`,children:A?e.jsx(I,{className:"h-3 w-3 animate-spin inline"}):t?`${t.score}% Match`:"Analyze Fit"}):e.jsx("span",{className:"text-xs text-slate-400",children:"Upload resume to analyze"}),n.url&&n.url.trim()&&n.url.startsWith("http")?e.jsxs("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 px-3 py-1.5 text-xs font-medium text-white rounded transition-all shadow-sm hover:shadow-md hover:opacity-90 flex items-center gap-1.5 whitespace-nowrap",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},title:"View job posting",onClick:p=>{p.stopPropagation(),console.log("[Scout] Opening job URL:",n.url)},children:[e.jsx(U,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"View"})]}):e.jsxs("button",{disabled:!0,className:"flex-shrink-0 px-3 py-1.5 text-xs font-medium bg-slate-100 text-slate-400 rounded cursor-not-allowed flex items-center gap-1.5 whitespace-nowrap",title:"Job URL not available",children:[e.jsx(U,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"View"})]})]})]})}),o&&t&&e.jsxs("div",{className:"border-t border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:`text-2xl font-bold ${t.score>=70?"text-green-600":t.score>=50?"text-yellow-600":"text-orange-600"}`,children:[t.score,"%"]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[t.match_level==="strong"&&"ðŸŽ¯ Strong Match",t.match_level==="good"&&"ðŸ‘ Good Match",t.match_level==="moderate"&&"ðŸ¤” Moderate Match",t.match_level==="stretch"&&"ðŸŒ± Stretch Role"]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Based on your resume"})]})]}),t.strengths&&t.strengths.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs font-medium text-slate-700 mb-2",children:"What aligns:"}),e.jsx("div",{className:"space-y-2",children:t.strengths.map((p,k)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"âœ“"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-slate-800",children:p.point}),e.jsxs("span",{className:"text-xs text-slate-500 ml-1",children:["â€” ",p.evidence]})]})]},k))})]}),t.gaps&&t.gaps.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs font-medium text-slate-700 mb-2",children:"Gaps to address:"}),e.jsx("div",{className:"space-y-2",children:t.gaps.map((p,k)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-orange-500 mt-0.5",children:"!"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-slate-800",children:p.gap}),e.jsxs("div",{className:"text-xs text-slate-600 mt-0.5",children:["ðŸ’¡ ",p.mitigation]})]})]},k))})]}),t.pitch&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-100",children:[e.jsx("div",{className:"text-xs font-medium text-blue-800 mb-1",children:"ðŸ’¬ How to pitch yourself:"}),e.jsxs("div",{className:"text-sm text-blue-900 italic",children:['"',t.pitch,'"']})]}),t.talking_points&&t.talking_points.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-xs font-medium text-slate-700 mb-2",children:"Talking points for outreach:"}),e.jsx("ul",{className:"space-y-1",children:t.talking_points.map((p,k)=>e.jsxs("li",{className:"text-sm text-slate-700 flex gap-2",children:[e.jsx("span",{className:"text-slate-400",children:"â€¢"}),e.jsx("span",{children:p})]},k))})]}),t.keywords_to_use&&t.keywords_to_use.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:t.keywords_to_use.map((p,k)=>e.jsx("span",{className:"px-2 py-0.5 bg-slate-200 text-slate-700 text-xs rounded",children:p},k))}),e.jsxs("div",{className:"flex gap-2 mt-4 pt-3 border-t border-slate-200",children:[e.jsx("button",{onClick:()=>{if(t){const p={job_title:n.title,company:n.company,score:t.score,match_level:t.match_level,pitch:t.pitch,talking_points:t.talking_points,strengths:t.strengths,gaps:t.gaps,keywords:t.keywords_to_use};localStorage.setItem("scout_fit_context",JSON.stringify(p)),console.log("[Scout] Stored fit context for email generation:",p)}R(n)},className:"flex-1 py-2 text-sm font-medium text-white rounded",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:"Find Contacts in This Role"}),e.jsx("button",{onClick:()=>$(null),className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded",children:"Collapse"})]})]})]},u)})]})]})},s.id)),e.jsx("div",{ref:v}),r&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-slate-100 border border-slate-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(I,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"text-sm",children:"Scout is thinking..."})]})})})]})]}),e.jsx("div",{className:"px-4 py-3 border-t border-[#E3E8F0] bg-white",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{ref:j,value:l,onChange:s=>f(s.target.value),onKeyPress:P,placeholder:"Paste a job URL or describe what you're looking for...",className:"flex-1 bg-white border-[#E3E8F0] text-slate-900 placeholder:text-slate-400 focus:border-blue-500 focus-visible:ring-2 focus-visible:ring-blue-500/20 rounded-md",disabled:r}),e.jsx(Y,{onClick:F,disabled:!l.trim()||r,className:"hover:opacity-90 rounded-md",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:r?e.jsx(I,{className:"h-4 w-4 animate-spin"}):e.jsx(V,{className:"h-4 w-4"})})]})})]})},re=({onJobTitleSuggestion:a})=>{const{user:i}=ee(),[d,h]=x.useState(!1),[l,f]=x.useState({x:0,y:0}),[r,m]=x.useState({width:370,height:600}),[y,b]=x.useState(null);x.useEffect(()=>{d&&!P.current?(f({x:Math.max(16,window.innerWidth-r.width-16),y:16}),P.current=!0):d||(P.current=!1)},[d]),x.useEffect(()=>{const w=()=>{if(d){const g=window.innerWidth-r.width,s=window.innerHeight-r.height;f(n=>({x:Math.max(0,Math.min(n.x,g)),y:Math.max(0,Math.min(n.y,s))}))}};return window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[d,r]);const[v,j]=x.useState(!1),[C,M]=x.useState(!1),[_,T]=x.useState({x:0,y:0}),[S,$]=x.useState({x:0,y:0,width:0,height:0,posX:0,posY:0}),F=x.useRef(null),P=x.useRef(!1);x.useEffect(()=>{(async()=>{if(i!=null&&i.uid)try{const g=W(te,"users",i.uid),s=await K(g);if(s.exists()){const n=s.data(),u={};n.resumeParsed&&Object.assign(u,n.resumeParsed),n.resumeText&&(u.rawText=n.resumeText),b(u)}}catch(g){console.error("[ScoutHeaderButton] Failed to load resume:",g)}})()},[i==null?void 0:i.uid]),x.useEffect(()=>{const w=`
      @keyframes wave {
        0%, 100% { transform: rotate(-8deg); }
        50% { transform: rotate(8deg); }
      }
      @keyframes ping-soft {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.25); opacity: 0.4; }
        100% { transform: scale(1); opacity: 1; }
      }
    `,g=document.createElement("style");return g.textContent=w,document.head.appendChild(g),()=>{document.head.contains(g)&&document.head.removeChild(g)}},[]);const R=w=>{if(F.current){j(!0);const g=F.current.getBoundingClientRect();T({x:w.clientX-g.left,y:w.clientY-g.top}),w.preventDefault()}},O=w=>{if(w.stopPropagation(),w.preventDefault(),F.current){M(!0);const g=F.current.getBoundingClientRect();$({x:w.clientX,y:w.clientY,width:g.width,height:g.height,posX:l.x,posY:l.y})}};return x.useEffect(()=>{const w=s=>{if(v){const n=s.clientX-_.x,u=s.clientY-_.y,c=window.innerWidth-r.width,t=window.innerHeight-r.height;f({x:Math.max(0,Math.min(n,c)),y:Math.max(0,Math.min(u,t))})}else if(C){const n=s.clientX-S.x,u=s.clientY-S.y,c=300,t=400,o=S.width-n,A=S.height-u,p=S.posX+n,k=S.posY+u,N=window.innerWidth-p,B=window.innerHeight-k,D=Math.max(c,Math.min(o,N)),L=Math.max(t,Math.min(A,B)),z=S.posX+(S.width-D),X=S.posY+(S.height-L);m({width:D,height:L}),f({x:Math.max(0,z),y:Math.max(0,X)})}},g=()=>{j(!1),M(!1)};return(v||C)&&(document.addEventListener("mousemove",w),document.addEventListener("mouseup",g)),()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",g)}},[v,C,_,S,r,l]),e.jsxs(e.Fragment,{children:[d&&e.jsxs("div",{ref:F,className:"fixed z-40 flex flex-col rounded-2xl border border-[#E3E8F0] bg-white shadow-lg overflow-hidden",style:{left:`${l.x}px`,top:`${l.y}px`,width:`${r.width}px`,height:`${r.height}px`,cursor:v?"grabbing":"default",userSelect:v||C?"none":"auto"},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[#E3E8F0] bg-white cursor-grab active:cursor-grabbing select-none",onMouseDown:R,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center overflow-hidden",style:{backgroundColor:"#fff6e2"},children:e.jsx("img",{src:"/scout-mascot.png",alt:"Scout AI",className:"w-6 h-6 object-contain"})}),e.jsx("div",{children:e.jsx("h3",{className:"text-sm font-semibold text-slate-900",children:"Scout AI"})})]}),e.jsx("button",{onClick:()=>h(!1),className:"text-xs text-slate-500 hover:text-slate-700 transition-colors",children:"Close"})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:e.jsx(ie,{onJobTitleSuggestion:a,userResume:y||void 0})}),e.jsx("div",{className:"absolute top-0 left-0 w-6 h-6 cursor-nwse-resize z-10",onMouseDown:O,style:{background:"linear-gradient(to bottom right, transparent 0%, transparent 40%, #E3E8F0 40%, #E3E8F0 45%, transparent 45%, transparent 100%)"},children:e.jsx("div",{className:"absolute top-1 left-1 w-3 h-3 border-l-2 border-t-2 border-slate-400"})})]}),e.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center gap-2 rounded-full border px-3 py-1.5 bg-[#ECF4FF] border-[#C7D8FF] text-sm font-medium text-[#111827] shadow-sm hover:shadow-md hover:scale-105 hover:bg-gradient-to-r hover:from-[#ECF4FF] hover:to-white cursor-pointer transition-all duration-150",children:[e.jsxs("div",{className:"relative flex items-center justify-center h-6 w-6 rounded-full bg-[#FFF7EA] flex-shrink-0",children:[e.jsx("img",{src:"/scout-mascot.png",alt:"Scout AI",className:"w-4 h-4 object-contain",style:{animation:"wave 2.5s ease-in-out infinite",transformOrigin:"center bottom"}}),e.jsx("span",{className:"absolute -top-0.5 -right-0.5 h-2.5 w-2.5 rounded-full bg-[#3B82F6]",style:{animation:"ping-soft 1.2s ease-in-out infinite"}})]}),e.jsx("span",{className:"whitespace-nowrap hidden sm:inline",children:"Ask Scout"})]})]})};function be({onJobTitleSuggestion:a}){const i=q(),d=()=>{i("/home?tab=outbox")};return e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0",children:[e.jsx(Y,{variant:"ghost",size:"icon",onClick:d,className:"h-9 w-9 hover:bg-blue-100 hover:text-blue-600 flex-shrink-0","aria-label":"View outbox",children:e.jsx(Q,{className:"h-5 w-5"})}),e.jsx(Y,{variant:"ghost",size:"icon",onClick:()=>i("/home?tab=calendar"),className:"h-9 w-9 hover:bg-blue-100 hover:text-blue-600 flex-shrink-0","aria-label":"View calendar",children:e.jsx(Z,{className:"h-5 w-5"})}),e.jsx(re,{onJobTitleSuggestion:a})]})}export{be as P,ae as a,he as b,ue as c,ge as d,pe as e,ye as f,fe as g,xe as l};
