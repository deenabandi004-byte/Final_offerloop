import{j as e}from"./vendor-ui-Dvm6rNa4.js";import{r as u,a as ue}from"./vendor-react-BYoYq924.js";import{S as Ce,A as De,a as Fe,b as pe}from"./AppSidebar-Cn2aJ38A.js";import{T as he,a as ge,b as B,c as M}from"./tabs-B3Jp1R5J.js";import{a as Ae,B as C,x as fe,t as p}from"./index-BlHBLROI.js";import{D as G,a as I}from"./api-BaCf4yf7.js";import{C as z,a as be,b as je,c as J}from"./card-BhhoFDdW.js";import{I as v}from"./input-XODqQdub.js";import{B as ve}from"./badge-BdqHLg7L.js";import{L as Te,B as we,C as h}from"./LockedFeatureOverlay-CsomAHDv.js";import{I as y}from"./constants-CpKbYGZX.js";import{f as Le,l as Re}from"./activityLogger-hKmX71uM.js";import{P as Ee,a as Ne}from"./PageHeaderActions-DBb3HQNj.js";import{B as O}from"./briefcase-dTGXHmKy.js";import{F as ye}from"./file-text-anY0C2WZ.js";import{C as $}from"./circle-x-BeHmYZBE.js";import{L as W}from"./loader-circle-Dc92CH8W.js";import{B as Pe}from"./badge-check-8cj4Bimp.js";import"./avatar-Dzw8yNMj.js";import"./user-C_wegfzu.js";import"./search-BYePgFCK.js";import"./credit-card-CUtRkOcf.js";import"./settings-DRsa6wdQ.js";import"./chevron-down-BYs8h_N4.js";import"./zap-4xeOdT8m.js";import"./firebaseApi-DOnxKxO3.js";import"./external-link-CNjLoQl2.js";const xs=()=>{var re,ae,ie,ne,le,oe,de,ce;const{user:P,checkCredits:R}=Ae(),E=P||{credits:0,tier:"free"},[m,D]=u.useState(!1),[V,g]=u.useState(""),[ke,Y]=u.useState(null),[r,Q]=u.useState(null),[x,F]=u.useState("idle"),[f,X]=u.useState(""),[l,Ie]=u.useState(null),[q,H]=u.useState(!1),[w,S]=u.useState(""),[N,_]=u.useState(""),[A,K]=u.useState([]),[Z,Se]=u.useState(!0),[qe,Ue]=u.useState(null);u.useEffect(()=>{(async()=>{try{const t=await I.getInterviewPrepHistory(1e3);if("error"in t)throw new Error(t.error);K(t.history||[])}catch(t){console.error("Failed to load interview preps:",t),p({title:"Unable to load library",description:t instanceof Error?t.message:"Please try again.",variant:"destructive"})}finally{Se(!1)}})()},[]),u.useEffect(()=>{x==="completed"&&setTimeout(()=>{(async()=>{try{const t=await I.getInterviewPrepHistory(1e3);if("error"in t)throw new Error(t.error);K(t.history||[])}catch(t){console.error("Failed to reload interview preps:",t)}})()},2e3)},[x]);const ee=async()=>{console.log("ðŸŽ¬ handleInterviewPrepSubmit called");const s=f.trim(),t=w.trim()&&N.trim();if(!s&&!t){p({title:"Missing Information",description:"Please enter a job posting URL, or provide company name and job title.",variant:"destructive"});return}if(!P){p({title:"Authentication Required",description:"Please sign in to continue.",variant:"destructive"});return}if(E.credits<y){p({title:"Insufficient Credits",description:`You need ${y} credits to generate an interview prep.`,variant:"destructive"});return}D(!0),F("processing"),g("Analyzing job posting..."),Q(null);try{const n={};f.trim()?n.job_posting_url=f.trim():(n.company_name=w.trim(),n.job_title=N.trim());const k=await I.generateInterviewPrep(n);if("error"in k)throw new Error(k.error);const o=k.id;Y(o);let i=0;const d=120;await new Promise((j,T)=>{const L=setInterval(async()=>{i++,console.log(`ðŸ”„ Interview Prep Poll ${i} starting...`);try{const a=await I.getInterviewPrepStatus(o);if(console.log(`Poll ${i}:`,a),"error"in a&&!("status"in a)){clearInterval(L),T(new Error(a.error));return}if("status"in a){const c=a.status;g(c==="parsing_job_posting"?a.progress||"Analyzing job posting...":c==="extracting_requirements"?a.progress||"Extracting role requirements...":c==="scraping_reddit"?a.progress||"Searching Reddit for interview experiences...":c==="processing_content"?a.progress||"Processing insights...":c==="generating_pdf"?a.progress||"Generating your prep guide...":a.progress||"Processing your request..."),a.jobDetails&&Ie(a.jobDetails)}if(a.pdfUrl){if(clearInterval(L),console.log("âœ… Interview Prep completed! pdfUrl:",a.pdfUrl),P!=null&&P.uid&&a.jobDetails)try{const c=a.jobDetails,me=c.job_title||N.trim()||"",xe=c.company_name||w.trim()||"",_e=Le({roleTitle:me||void 0,company:xe||void 0});await Re(P.uid,"interviewPrep",_e,{prepId:o,roleTitle:me||"",company:xe||"",jobPostingUrl:f.trim()||""})}catch(c){console.error("Failed to log interview prep activity:",c)}ue.flushSync(()=>{D(!1),F("completed"),g("Interview Prep ready!"),Q(a),Y(a.id||o)}),p({title:"Interview Prep Ready!",description:"Your interview prep PDF has been generated successfully.",duration:5e3}),R&&R().then(()=>{console.log("âœ… Interview Prep complete!")}),j(a);return}if(a.status==="failed"||a.status==="parsing_failed"){if(clearInterval(L),a.needsManualInput||a.status==="parsing_failed"){H(!0),D(!1),F("idle"),p({title:"URL Parsing Failed",description:"Please enter the company name and job title manually below.",variant:"default"}),j(a);return}T(new Error(a.error||"Generation failed"));return}if(i>=d){clearInterval(L),setTimeout(async()=>{try{const c=await I.getInterviewPrepStatus(o);"pdfUrl"in c&&c.pdfUrl?(ue.flushSync(()=>{D(!1),F("completed"),g("Interview Prep ready!"),Q(c),Y(c.id||o)}),p({title:"Interview Prep Ready!",description:"Your interview prep PDF has been generated successfully.",duration:5e3}),R&&R(),j(c)):T(new Error("Generation is taking longer than expected. Please check back in a few minutes."))}catch{T(new Error("Generation timed out. Please try again or check back later."))}},2e3);return}}catch(a){clearInterval(L),T(a)}},3e3)})}catch(n){console.error("Interview prep failed:",n),F("failed"),g("Generation failed"),p({title:"Generation Failed",description:n.message||"Please try again.",variant:"destructive"})}finally{D(!1)}},se=async s=>{const t=ke;if(!(!t||!P))try{let o;p({title:"Preparing PDF",description:"Please wait while we prepare your Interview Prep PDF...",duration:3e3});for(let i=0;i<20;i++){try{const d=await I.downloadInterviewPrepPDF(t);if(o=(d==null?void 0:d.pdfUrl)||void 0,o&&(await fetch(o,{method:"HEAD"})).ok)break}catch{}await new Promise(d=>setTimeout(d,1e3))}if(!o)throw new Error("PDF isn't ready yet. Please try again in a moment.");await new Promise(i=>setTimeout(i,500));try{const i=await fetch(o);if(!i.ok)throw new Error(`Failed to fetch PDF: ${i.status}`);const d=await i.blob(),U=window.URL.createObjectURL(d),j=document.createElement("a");j.href=U,j.download=`interview-prep-${t}.pdf`,j.style.display="none",document.body.appendChild(j),j.click(),setTimeout(()=>{document.body.removeChild(j),window.URL.revokeObjectURL(U)},100),p({title:"PDF Downloaded",description:"Your Interview Prep PDF has been downloaded.",duration:3e3})}catch(i){console.warn("Blob download failed, trying direct link:",i);const d=document.createElement("a");d.href=o,d.download=`interview-prep-${t}.pdf`,d.target="_blank",d.rel="noopener noreferrer",d.style.display="none",document.body.appendChild(d),d.click(),setTimeout(()=>{document.body.removeChild(d)},100),p({title:"PDF Download Started",description:"Your Interview Prep PDF download has started.",duration:3e3})}}catch(n){p({title:"Download Failed",description:n instanceof Error?n.message:"Could not download the PDF.",variant:"destructive"})}},te=async s=>{try{if(s.pdfUrl){window.open(s.pdfUrl,"_blank","noopener");return}const{pdfUrl:t}=await I.downloadInterviewPrepPDF(s.id);if(t)window.open(t,"_blank","noopener");else throw new Error("PDF URL not available yet")}catch{p({title:"Download failed",description:"Could not open the PDF. Please try again.",variant:"destructive"})}},b=u.useMemo(()=>{const s=A.filter(n=>n.status==="completed"),t=A.filter(n=>n.status!=="completed");return{completed:s,inProgress:t}},[A]);return e.jsx(Ce,{children:e.jsxs("div",{className:"flex min-h-screen w-full bg-transparent text-foreground",children:[e.jsx(De,{}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("header",{className:"h-16 flex items-center justify-between border-b border-gray-100/30 px-6 bg-transparent shadow-sm relative z-20",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Fe,{className:"text-foreground hover:bg-secondary"}),e.jsx("h1",{className:"text-xl font-semibold",children:"Interview Prep"})]}),e.jsx(Ee,{})]}),e.jsx("main",{className:"p-8 bg-transparent",children:e.jsx("div",{className:"max-w-5xl mx-auto",children:E.tier!=="pro"?e.jsx(Te,{featureName:"Interview Prep",requiredTier:"Pro",children:e.jsxs(he,{defaultValue:"interview-prep",className:"w-full",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs(ge,{className:"h-14 tabs-container-gradient border border-border grid grid-cols-2 max-w-lg w-full rounded-xl p-1 bg-white",children:[e.jsxs(B,{value:"interview-prep",className:"h-12 font-medium text-base data-[state=active] data-[state=active]:text-white data-[state=inactive]:text-muted-foreground transition-all",children:[e.jsx(O,{className:"h-5 w-5 mr-2"}),"Interview Prep"]}),e.jsxs(B,{value:"interview-library",className:"h-12 font-medium text-base data-[state=active] data-[state=active]:text-white data-[state=inactive]:text-muted-foreground transition-all",children:[e.jsx(ye,{className:"h-5 w-5 mr-2"}),"Interview Library"]})]})}),e.jsx(M,{value:"interview-prep",className:"mt-6",children:e.jsxs(z,{className:"bg-white border-border relative overflow-hidden",children:[e.jsx(be,{className:"border-b border-border",children:e.jsxs(je,{className:"text-xl text-foreground flex items-center gap-2",children:["Interview Prep",e.jsx(we,{size:"xs",variant:"glow"}),e.jsxs(ve,{variant:"secondary",className:"ml-auto",children:[y," credits"]})]})}),e.jsx(J,{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Job Posting URL ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(v,{value:f,onChange:s=>{X(s.target.value),s.target.value.trim()&&(H(!1),S(""),_(""))},placeholder:"Paste the job posting URL here...",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Supports LinkedIn, Indeed, Greenhouse, Lever, Workday, and most career pages. If URL parsing fails, you can enter company and job title manually below."})]}),!q&&!f.trim()&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Or enter manually:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-foreground",children:"Company Name"}),e.jsx(v,{value:w,onChange:s=>S(s.target.value),placeholder:"e.g., Google, Amazon, Meta",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-foreground",children:"Job Title"}),e.jsx(v,{value:N,onChange:s=>_(s.target.value),placeholder:"e.g., Software Engineer, Data Scientist",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m})]})]}),l&&e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4 border border-border",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground mb-3",children:"Job Details Preview:"}),e.jsxs("div",{className:"space-y-2 text-sm text-foreground",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Company:"})," ",l.company_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Role:"})," ",l.job_title]}),l.level&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Level:"})," ",l.level]}),l.team_division&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Team:"})," ",l.team_division]}),l.required_skills&&l.required_skills.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Key Skills:"})," ",l.required_skills.slice(0,5).join(", "),l.required_skills.length>5&&` +${l.required_skills.length-5} more`]})]})]}),q&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx($,{className:"h-5 w-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-yellow-800 mb-1",children:"URL Parsing Failed - Manual Input Required"}),e.jsx("p",{className:"text-xs text-yellow-700/80 mb-3",children:"We couldn't parse the job posting URL. Please enter the details manually below."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Company Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(v,{value:w,onChange:s=>S(s.target.value),placeholder:"e.g., Google, Amazon, Meta",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Job Title ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(v,{value:N,onChange:s=>_(s.target.value),placeholder:"e.g., Software Engineer, Data Scientist, Product Manager",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m})]})]})]}),e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4 border border-border",children:[e.jsx("p",{className:"text-sm text-foreground mb-2",children:e.jsx("span",{className:"font-semibold text-foreground",children:"What you'll receive:"})}),e.jsxs("ul",{className:"space-y-1.5 text-sm text-foreground",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Company-specific interview process overview"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Common questions grouped by category (Behavioral, Technical, System Design, etc.)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Success tips from candidates who passed"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Red flags and things to avoid"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Culture insights and work environment details"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:["Uses ",y," credits. Analyzes the job posting, searches Reddit for role-specific interview insights, and generates a comprehensive 5-6 page prep guide tailored to this specific role."]})]}),e.jsx(C,{onClick:ee,disabled:m||E.credits<y||!f.trim()&&(!w.trim()||!N.trim()),className:"w-full text-white font-semibold py-6 text-base shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:m?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-5 w-5 mr-2 animate-spin"}),"Generating Interview Prep..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-5 w-5 mr-2"}),"Generate Interview Prep"]})}),x!=="idle"&&e.jsxs("div",{className:"rounded-lg border border-border bg-muted/50 p-4 shadow-inner text-sm text-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m?e.jsx(W,{className:"h-4 w-4 animate-spin text-primary"}):x==="completed"?e.jsx(h,{className:"h-4 w-4 text-blue-600"}):x==="failed"?e.jsx($,{className:"h-4 w-4 text-destructive"}):null,e.jsx("span",{className:"font-medium",children:x==="completed"?"Ready!":x==="failed"?"Failed":"Processing..."})]}),e.jsx("span",{className:"text-muted-foreground",children:V||"Processing your request..."})]}),x==="completed"&&r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-xl border border-green-500/40 bg-green-500/10 p-5 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-green-700 uppercase tracking-wide",children:[((re=r.jobDetails)==null?void 0:re.job_title)||((ae=r.jobDetails)==null?void 0:ae.company_name)||"Interview Prep"," - ",((ie=r.jobDetails)==null?void 0:ie.company_name)||""]}),e.jsx("span",{className:"text-xs text-blue-600/80",children:"Ready to download"})]}),r.insights&&e.jsxs("div",{className:"space-y-3 text-sm text-foreground",children:[((ne=r.insights.interview_process)==null?void 0:ne.stages)&&r.insights.interview_process.stages.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Interview Stages: "}),r.insights.interview_process.stages.map(s=>typeof s=="string"?s:(s==null?void 0:s.name)||"Stage").join(", ")]}),r.insights.common_questions&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Question Categories: "}),(()=>{const s=r.insights.common_questions;if(Array.isArray(s))return s.map(t=>t.category).join(", ");if(typeof s=="object"&&s!==null){const t=[],n=s;return n.behavioral&&t.push("Behavioral"),n.technical&&t.push("Technical"),n.company_specific&&t.push("Company-Specific"),t.join(", ")}return""})(),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Sample questions preview:",e.jsx("ul",{className:"list-disc list-inside mt-1 space-y-1",children:(()=>{var n,k;const s=r.insights.common_questions,t=[];if(Array.isArray(s))s.slice(0,3).forEach(o=>{o.questions&&o.questions.slice(0,2).forEach(i=>{t.push(i)})});else if(typeof s=="object"&&s!==null){const o=s;(n=o.behavioral)!=null&&n.questions&&o.behavioral.questions.slice(0,2).forEach(i=>{t.push(typeof i=="string"?i:i.question||"")}),(k=o.technical)!=null&&k.questions&&t.length<3&&o.technical.questions.slice(0,2).forEach(i=>{t.push(typeof i=="string"?i:i.question||"")})}return t.slice(0,3).map((o,i)=>e.jsx("li",{className:"text-foreground",children:o},i))})()})]})]}),r.insights.sources_count&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Sources: "}),"Analyzed ",r.insights.sources_count," Reddit posts"]})]})]}),e.jsxs(C,{onClick:()=>se(),className:"w-full text-white font-semibold py-6 text-base shadow-lg",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:[e.jsx(G,{className:"h-5 w-5 mr-2"}),"Download Full PDF"]})]}),x==="failed"&&(r==null?void 0:r.error)&&e.jsx("div",{className:"rounded-lg border border-red-500/40 bg-red-500/10 p-4",children:e.jsx("p",{className:"text-sm text-red-700",children:r.error})})]})})})]})}),e.jsx(M,{value:"interview-library",className:"mt-6",children:e.jsx("div",{className:"space-y-6",children:Z?e.jsx(z,{className:"bg-white border-border",children:e.jsx(J,{className:"p-6",children:e.jsx(fe,{variant:"card",count:3})})}):A.length===0?e.jsxs("div",{className:"rounded-xl border border-border bg-white p-10 text-center space-y-4",children:[e.jsx(O,{className:"h-10 w-10 mx-auto text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"No preps yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate your first interview prep to see it appear here."})]}):e.jsxs("div",{className:"space-y-6",children:[b.inProgress.length>0&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase mb-3",children:"In Progress"}),e.jsx("div",{className:"grid gap-4",children:b.inProgress.map(s=>e.jsxs("div",{className:"rounded-lg border border-yellow-500/40 bg-yellow-500/10 px-5 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-foreground font-medium",children:s.companyName}),s.jobTitle&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.jobTitle}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Requested ",s.createdAt?new Date(s.createdAt).toLocaleString():""]})]}),e.jsx("div",{className:"text-xs uppercase text-yellow-600",children:"Processing..."})]},s.id))})]}),b.completed.length>0&&e.jsxs("section",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:["Completed (",b.completed.length,")"]}),e.jsx("div",{className:"grid gap-4",children:b.completed.map(s=>e.jsxs("div",{className:"rounded-xl border border-border bg-white p-5 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-foreground font-medium",children:[e.jsx(Pe,{className:"h-4 w-4 text-primary"}),s.companyName]}),s.jobTitle&&e.jsx("div",{className:"text-sm text-foreground",children:s.jobTitle}),e.jsx("div",{className:"flex flex-wrap items-center gap-3 text-xs text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"}),s.createdAt?new Date(s.createdAt).toLocaleDateString():"â€”"]})})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(C,{size:"sm",variant:"outline",className:"border-primary text-primary hover:bg-primary/10",onClick:()=>te(s),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"PDF"]})})]},s.id))})]})]})})})]})}):e.jsxs(he,{defaultValue:"interview-prep",className:"w-full",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs(ge,{className:"h-14 tabs-container-gradient border border-border grid grid-cols-2 max-w-lg w-full rounded-xl p-1 bg-white",children:[e.jsxs(B,{value:"interview-prep",className:"h-12 font-medium text-base data-[state=active] data-[state=active]:text-white data-[state=inactive]:text-muted-foreground transition-all",children:[e.jsx(O,{className:"h-5 w-5 mr-2"}),"Interview Prep"]}),e.jsxs(B,{value:"interview-library",className:"h-12 font-medium text-base data-[state=active] data-[state=active]:text-white data-[state=inactive]:text-muted-foreground transition-all",children:[e.jsx(ye,{className:"h-5 w-5 mr-2"}),"Interview Library"]})]})}),e.jsx(M,{value:"interview-prep",className:"mt-6",children:e.jsxs(z,{className:"bg-white border-border relative overflow-hidden",children:[e.jsx(be,{className:"border-b border-border",children:e.jsxs(je,{className:"text-xl text-foreground flex items-center gap-2",children:["Interview Prep",e.jsx(we,{size:"xs",variant:"glow"}),e.jsxs(ve,{variant:"secondary",className:"ml-auto",children:[y," credits"]})]})}),e.jsx(J,{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Job Posting URL ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(v,{value:f,onChange:s=>{X(s.target.value),s.target.value.trim()&&(H(!1),S(""),_(""))},placeholder:"Paste the job posting URL here...",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Supports LinkedIn, Indeed, Greenhouse, Lever, Workday, and most career pages. If URL parsing fails, you can enter company and job title manually below."})]}),!q&&!f.trim()&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Or enter manually:"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-foreground",children:"Company Name"}),e.jsx(v,{value:w,onChange:s=>S(s.target.value),placeholder:"e.g., Google, Amazon, Meta",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-foreground",children:"Job Title"}),e.jsx(v,{value:N,onChange:s=>_(s.target.value),placeholder:"e.g., Software Engineer, Data Scientist",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m})]})]}),l&&e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4 border border-border",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground mb-3",children:"Job Details Preview:"}),e.jsxs("div",{className:"space-y-2 text-sm text-foreground",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Company:"})," ",l.company_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Role:"})," ",l.job_title]}),l.level&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Level:"})," ",l.level]}),l.team_division&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Team:"})," ",l.team_division]}),l.required_skills&&l.required_skills.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Key Skills:"})," ",l.required_skills.slice(0,5).join(", "),l.required_skills.length>5&&` +${l.required_skills.length-5} more`]})]})]}),q&&e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx($,{className:"h-5 w-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-yellow-800 mb-1",children:"URL Parsing Failed - Manual Input Required"}),e.jsx("p",{className:"text-xs text-yellow-700/80 mb-3",children:"We couldn't parse the job posting URL. Please enter the details manually below."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Company Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(v,{value:w,onChange:s=>S(s.target.value),placeholder:"e.g., Google, Amazon, Meta",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-foreground",children:["Job Title ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(v,{value:N,onChange:s=>_(s.target.value),placeholder:"e.g., Software Engineer, Data Scientist, Product Manager",className:"bg-white border-input text-foreground placeholder:text-muted-foreground focus:border-pink-500 hover:border-purple-400 transition-colors",disabled:m})]})]})]}),e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4 border border-border",children:[e.jsx("p",{className:"text-sm text-foreground mb-2",children:e.jsx("span",{className:"font-semibold text-foreground",children:"What you'll receive:"})}),e.jsxs("ul",{className:"space-y-1.5 text-sm text-foreground",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Company-specific interview process overview"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Common questions grouped by category (Behavioral, Technical, System Design, etc.)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Success tips from candidates who passed"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Red flags and things to avoid"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Culture insights and work environment details"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:["Uses ",y," credits. Analyzes the job posting, searches Reddit for role-specific interview insights, and generates a comprehensive 5-6 page prep guide tailored to this specific role."]})]}),e.jsx(C,{onClick:ee,disabled:m||E.credits<y||!f.trim()&&(!w.trim()||!N.trim()),className:"w-full text-white font-semibold py-6 text-base shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:m?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-5 w-5 mr-2 animate-spin"}),"Generating Interview Prep..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-5 w-5 mr-2"}),"Generate Interview Prep"]})}),x!=="idle"&&e.jsxs("div",{className:"rounded-lg border border-border bg-muted/50 p-4 shadow-inner text-sm text-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m?e.jsx(W,{className:"h-4 w-4 animate-spin text-primary"}):x==="completed"?e.jsx(h,{className:"h-4 w-4 text-blue-600"}):x==="failed"?e.jsx($,{className:"h-4 w-4 text-destructive"}):null,e.jsx("span",{className:"font-medium",children:x==="completed"?"Ready!":x==="failed"?"Failed":"Processing..."})]}),e.jsx("span",{className:"text-muted-foreground",children:V||"Processing your request..."})]}),x==="completed"&&r&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-xl border border-green-500/40 bg-green-500/10 p-5 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-green-700 uppercase tracking-wide",children:[((le=r.jobDetails)==null?void 0:le.job_title)||((oe=r.jobDetails)==null?void 0:oe.company_name)||"Interview Prep"," - ",((de=r.jobDetails)==null?void 0:de.company_name)||""]}),e.jsx("span",{className:"text-xs text-blue-600/80",children:"Ready to download"})]}),r.insights&&e.jsxs("div",{className:"space-y-3 text-sm text-foreground",children:[((ce=r.insights.interview_process)==null?void 0:ce.stages)&&r.insights.interview_process.stages.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Interview Stages: "}),r.insights.interview_process.stages.map(s=>typeof s=="string"?s:(s==null?void 0:s.name)||"Stage").join(", ")]}),r.insights.common_questions&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Question Categories: "}),(()=>{const s=r.insights.common_questions;if(Array.isArray(s))return s.map(t=>t.category).join(", ");if(typeof s=="object"&&s!==null){const t=[],n=s;return n.behavioral&&t.push("Behavioral"),n.technical&&t.push("Technical"),n.company_specific&&t.push("Company-Specific"),t.join(", ")}return""})()]}),r.insights.sources_count&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Sources: "}),"Analyzed ",r.insights.sources_count," Reddit posts"]})]})]}),e.jsxs(C,{onClick:()=>se(),className:"w-full text-white font-semibold py-6 text-base shadow-lg",style:{background:"linear-gradient(135deg, #3B82F6, #60A5FA)"},children:[e.jsx(G,{className:"h-5 w-5 mr-2"}),"Download Full PDF"]})]}),x==="failed"&&(r==null?void 0:r.error)&&e.jsx("div",{className:"rounded-lg border border-red-500/40 bg-red-500/10 p-4",children:e.jsx("p",{className:"text-sm text-red-700",children:r.error})})]})})})]})}),e.jsx(M,{value:"interview-library",className:"mt-6",children:e.jsx("div",{className:"space-y-6",children:Z?e.jsx(z,{className:"bg-white border-border",children:e.jsx(J,{className:"p-6",children:e.jsx(fe,{variant:"card",count:3})})}):A.length===0?e.jsxs("div",{className:"rounded-xl border border-border bg-white p-10 text-center space-y-4",children:[e.jsx(O,{className:"h-10 w-10 mx-auto text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"No preps yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate your first interview prep to see it appear here."})]}):e.jsxs("div",{className:"space-y-6",children:[b.inProgress.length>0&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase mb-3",children:"In Progress"}),e.jsx("div",{className:"grid gap-4",children:b.inProgress.map(s=>e.jsxs("div",{className:"rounded-lg border border-yellow-500/40 bg-yellow-500/10 px-5 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-foreground font-medium",children:s.companyName}),s.jobTitle&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.jobTitle}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Requested ",s.createdAt?new Date(s.createdAt).toLocaleString():""]})]}),e.jsx("div",{className:"text-xs uppercase text-yellow-600",children:"Processing..."})]},s.id))})]}),b.completed.length>0&&e.jsxs("section",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground uppercase",children:["Completed (",b.completed.length,")"]}),e.jsx("div",{className:"grid gap-4",children:b.completed.map(s=>e.jsxs("div",{className:"rounded-xl border border-border bg-white p-5 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-foreground font-medium",children:[e.jsx(Pe,{className:"h-4 w-4 text-primary"}),s.companyName]}),s.jobTitle&&e.jsx("div",{className:"text-sm text-foreground",children:s.jobTitle}),e.jsx("div",{className:"flex flex-wrap items-center gap-3 text-xs text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"}),s.createdAt?new Date(s.createdAt).toLocaleDateString():"â€”"]})})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(C,{size:"sm",variant:"outline",className:"border-primary text-primary hover:bg-primary/10",onClick:()=>te(s),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"PDF"]})})]},s.id))})]})]})})})]})})})]})]})})};export{xs as default};
